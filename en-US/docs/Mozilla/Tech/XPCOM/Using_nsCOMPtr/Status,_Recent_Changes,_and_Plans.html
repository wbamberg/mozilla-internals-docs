<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/zilla-slab.css"/>
    <link rel="stylesheet" href="/css/page.css"/>
    <title>Status, Recent Changes, and Plans</title>
  </head>

  <body><div class="content-heading"><h1>Status, Recent Changes, and Plans</h1></div>
<div class="content"><p> </p>

<p>I'm sorry this section is in the way for first-time readers. You may want to skip directly to the <a href="/en/docs/Using_nsCOMPtr/Getting_Started_Guide">Getting Started Guide</a>, the <a href="/en/docs/Using_nsCOMPtr/Reference_Manual">Reference Manual</a>, or the <a href="/en/docs/Using_nsCOMPtr/Frequently_Asked_Questions">FAQ</a>. I put this section at the top so that checking for recent changes will be easy.</p>

<h3 id="Recent_changes_to_nsCOMPtr" name="Recent_changes_to_nsCOMPtr">Recent changes to <code>nsCOMPtr</code></h3>

<p>Most recent first</p>

<ul>
 <li>Made <code>==</code> and <code>!=</code> between an <code>nsCOMPtr</code> and a raw pointer (or a literal <code>0</code> or <code>nsnull</code>) work correctly on all compilers. See <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=65664" title="FIXED: nsCOMPtr:  make operator== always work with gcc">bug 65664</a>.</li>
 <li>Made <a href="/en/docs/Using_nsCOMPtr/Reference_Manual#.60Out.27_Parameters:_getter_AddRefs"><code>getter_AddRefs( nsCOMPtr&amp; )</code></a> apply the same <a href="/en/docs/Using_nsCOMPtr/Reference_Manual#Type_Safeguards">type-safety check</a> that the simple assignment forms do.</li>
 <li>Added <code>do_CreateInstance</code>.</li>
 <li>Added <code>do_GetService</code>.</li>
 <li>Eliminated the need to cast <code>getter_AddRefs</code> when an <code>nsISupports**</code> is needed.</li>
 <li>Relaxed the invariant for <code>nsCOMPtr&lt;nsISupports&gt;</code>, so that it is now a pointer to any XPCOM interface.</li>
 <li>Added <a href="/en/docs/Using_nsCOMPtr/Reference_Manual#nsCOMPtr.3CT.3E_.3D_do_QueryReferent.28_nsIWeakReference.2A_.29.2CnsCOMPtr.3CT.3E_.3D_do_QueryReferent.28_nsIWeakReference.2A.2C_nsresult.2A_.29"><code>do_QueryReferent</code></a> to make using <a href="/en/docs/Weak_reference"><code>nsIWeakReference</code>s</a> easier.</li>
</ul>

<h4 id="Plans_for_nsCOMPtr" name="Plans_for_nsCOMPtr">Plans for <code>nsCOMPtr</code></h4>

<ul>
 <li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=59212" title="FIXED: leaks with nsCOMPtr&lt;nsIAtom> foo = NS_NewAtom(...)">bug 59212</a>: as soon as we test on more compilers, start recommending <code>already_AddRefed</code> as a function result.</li>
 <li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=59414" title="FIXED: misuse of nsCOMPtr::operator&amp;">bug 59414</a>: making <code>operator&amp;</code> <code>private</code> may help prevent some <a href="/en/docs/Using_nsCOMPtr/Reference_Manual#Casting">leaks caused by casting</a></li>
 <li>Move the factored <code>nsCOMPtr</code> routines into their own library, to reduce <code>nsCOMPtr</code> clients' dependency on the XPCOM library.</li>
</ul>

<h4 id="Recent_changes_to_this_document" name="Recent_changes_to_this_document">Recent changes to this document</h4>

<ul>
 <li>Removed the statement that <code>==</code> and <code>!=</code> between an <code>nsCOMPtr</code> and a raw pointer or literal 0 does not work on some compilers since it is no longer true.</li>
 <li>Added an entire section to the Getting Started Guide on <a href="/en/docs/Using_nsCOMPtr/Getting_Started_Guide#nsCOMPtrs_in_function_signatures"><code>nsCOMPtr</code>s in function signatures</a></li>
 <li>Added references to recent bugs influencing the use of <code>nsCOMPtr</code> machinery: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=59212" title="FIXED: leaks with nsCOMPtr&lt;nsIAtom> foo = NS_NewAtom(...)">bug 59212</a>, and <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=59414" title="FIXED: misuse of nsCOMPtr::operator&amp;">bug 59414</a></li>
 <li>Fixed comparisons <a href="/en/docs/Using_nsCOMPtr/Getting_Started_Guide#Comparison_1">1</a> and <a href="/en/docs/Using_nsCOMPtr/Getting_Started_Guide#Comparison_3">3</a>, as per comments by Morten Welinder</li>
 <li>Updated examples to prefer direct initialization over copy initialization.</li>
</ul></div><div id="footer"><hr/><p>This page was originally written for <a href="https://developer.mozilla.org">developer.mozilla.org</a> and is used here under the <a href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike license</a> (CC-BY-SA).</p>
<p>Original contributors to this page: <a href="https://developer.mozilla.org/en-US/profiles/wbamberg">wbamberg</a>, <a href="https://developer.mozilla.org/en-US/profiles/mdnwebdocs-bot">mdnwebdocs-bot</a>, <a href="https://developer.mozilla.org/en-US/profiles/SphinxKnight">SphinxKnight</a>, <a href="https://developer.mozilla.org/en-US/profiles/teoli">teoli</a>, <a href="https://developer.mozilla.org/en-US/profiles/gsvelto">gsvelto</a>, <a href="https://developer.mozilla.org/en-US/profiles/kohei.yoshino">kohei.yoshino</a>.</p></div></body>
</html>
