<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/zilla-slab.css"/>
    <link rel="stylesheet" href="/css/page.css"/>
    <title>nsITransactionManager</title>
  </head>

  <body><nav class="breadcrumbs"><a href="../../../../../Mozilla.html">Mozilla</a>&raquo;<a href="../../../../Tech.html">Tech</a>&raquo;<a href="../../../XPCOM.html">XPCOM</a>&raquo;<a href="../../Reference.html">Reference</a>&raquo;<a href="../Interface.html">Interface</a></nav><div class="content-heading"><h1>nsITransactionManager</h1></div>
<div class="content"><p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/editor/txmgr/idl/nsITransactionManager.idl" rel="custom">editor/txmgr/idl/nsITransactionManager.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

This interface is implemented by an object that wants to manage/track transactions.
</span>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 1.7 </span></div>
</div><p></p>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table"> <tbody> <tr> <td><code>void <a href="#AddListener()">AddListener</a>(in nsITransactionListener aListener);</code></td> </tr> <tr> <td><code>void <a href="#beginBatch()">beginBatch</a>();</code></td> </tr> <tr> <td><code>void <a href="#clear()">clear</a>();</code></td> </tr> <tr> <td><code>void <a href="#doTransaction()">doTransaction</a>(in nsITransaction aTransaction);</code></td> </tr> <tr> <td><code>void <a href="#endBatch()">endBatch</a>();</code></td> </tr> <tr> <td><code>nsITransactionList <a href="#getRedoList()">getRedoList</a>();</code></td> </tr> <tr> <td><code>nsITransactionList <a href="#getUndoList()">getUndoList</a>();</code></td> </tr> <tr> <td><code>nsITransaction <a href="#peekRedoStack()">peekRedoStack</a>();</code></td> </tr> <tr> <td><code>nsITransaction <a href="#peekUndoStack()">peekUndoStack</a>();</code></td> </tr> <tr> <td><code>void <a href="#redoTransaction()">redoTransaction</a>();</code></td> </tr> <tr> <td><code>void <a href="#RemoveListener()">RemoveListener</a>(in nsITransactionListener aListener);</code></td> </tr> <tr> <td><code>void <a href="#undoTransaction()">undoTransaction</a>();</code></td> </tr> </tbody>
</table>
<h2 id="Attributes" name="Attributes">Attributes</h2>
<table class="standard-table"> <tbody> <tr> <td class="header">Attribute</td> <td class="header">Type</td> <td class="header">Description</td> </tr> <tr> <td><code>maxTransactionCount</code></td> <td><code><a href="/en/long" title="en/long">long</a></code></td> <td> <p>Sets the maximum number of transaction items the transaction manager will maintain at any time. This is commonly referred to as the number of levels of undo.</p> A value of -1 means no limit. A value of zero means the transaction manager will execute each transaction, then immediately release all references it has to the transaction without pushing it on the undo stack. A value greater than zero indicates the max number of transactions that can exist at any time on both the undo and redo stacks. This method will prune the necessary number of transactions on the undo and redo stacks if the value specified is less than the number of items that exist on both the undo and redo stacks.</td> </tr> <tr> <td><code>numberOfRedoItems</code></td> <td><code><a href="/en/long" title="en/long">long</a></code></td> <td>The number of items on the redo stack. <strong>Read only.</strong></td> </tr> <tr> <td><code>numberOfUndoItems</code></td> <td><code><a href="/en/long" title="en/long">long</a></code></td> <td>The number of items on the undo stack. <strong>Read only.</strong></td> </tr> </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<h3 id="AddListener()" name="AddListener()">AddListener()</h3>
<p>Adds a listener to the transaction manager's notification list. Listeners are notified whenever a transaction is done, undone, or redone. The listener's <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsITransactionListener#AddRef()">nsITransactionListener.AddRef()</a></code> method is called.</p>
<pre class="eval">void AddListener(
  in nsITransactionListener aListener
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aListener</code></dt> <dd>The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransactionListener" title="">nsITransactionListener</a></code> to add.</dd>
</dl>
<h3 id="beginBatch()" name="beginBatch()">beginBatch()</h3>
<p>Turns on the transaction manager's batch mode, forcing all transactions executed by the transaction manager's <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransactionManager#doTransaction()">doTransaction()</a></code> method to be aggregated together until <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransactionManager#EndBatch()">EndBatch()</a></code> is called. This mode allows an application to execute and group together several independent transactions so they can be undone with a single call to <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransactionManager#undoTransaction()">undoTransaction()</a></code>.</p>
<pre class="eval">void beginBatch();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h3 id="clear()" name="clear()">clear()</h3>
<p>Clears the undo and redo stacks.</p>
<pre class="eval">void clear();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h3 id="doTransaction()" name="doTransaction()">doTransaction()</h3>
<p>Calls a transaction's <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsITransaction#doTransaction()">nsITransaction.doTransaction()</a></code> method, then pushes it on the undo stack. This method calls the transaction's <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsITransaction#AddRef()">nsITransaction.AddRef()</a></code> method. The transaction's <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsITransaction#Release()">nsITransaction.Release()</a></code> method will be called when the undo or redo stack is pruned or when the transaction manager is destroyed.</p>
<pre class="eval">void doTransaction(
  in nsITransaction aTransaction
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aTransaction</code></dt> <dd>The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransaction" title="">nsITransaction</a></code> to do.</dd>
</dl>
<h3 id="endBatch()" name="endBatch()">endBatch()</h3>
<p>Turns off the transaction manager's batch mode.</p>
<pre class="eval">void endBatch();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h3 id="getRedoList()" name="getRedoList()">getRedoList()</h3>
<p>Returns the list of <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransaction" title="">nsITransaction</a></code> on the redo stack. Note that the transaction at the top of the redo stack will actually be at the index <code>n-1</code> in the list, where <code>n</code> is the number of items in the list.</p>
<pre class="eval">nsITransactionList getRedoList();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>A list of <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransaction" title="">nsITransaction</a></code> on the redo stack.</p>
<h3 id="getUndoList()" name="getUndoList()">getUndoList()</h3>
<p>Returns the list of <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransaction" title="">nsITransaction</a></code> on the undo stack. Note that the transaction at the top of the undo stack will actually be at the index <code>n-1</code> in the list, where <code>n</code> is the number of items in the list.</p>
<pre class="eval">nsITransactionList getUndoList();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>A list of <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransaction" title="">nsITransaction</a></code> on the undo stack.</p>
<h3 id="peekRedoStack()" name="peekRedoStack()">peekRedoStack()</h3>
<p>Returns an AddRef'd pointer to the <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransaction" title="">nsITransaction</a></code> at the top of the redo stack. Callers should be aware that this method could return a <code>null</code> in some implementations if there is a batch at the top of the redo stack.</p>
<pre class="eval">nsITransaction peekRedoStack();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>An AddRef'd pointer to the <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransaction" title="">nsITransaction</a></code> at the top of the redo stack.</p>
<h3 id="peekUndoStack()" name="peekUndoStack()">peekUndoStack()</h3>
<p>Returns an AddRef'd pointer to the <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransaction" title="">nsITransaction</a></code> at the top of the undo stack. Callers should be aware that this method could return a <code>null</code> in some implementations if there is a batch at the top of the undo stack.</p>
<pre class="eval">nsITransaction peekUndoStack();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>An AddRef'd pointer to the <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransaction" title="">nsITransaction</a></code> at the top of the undo stack.</p>
<h3 id="redoTransaction()" name="redoTransaction()">redoTransaction()</h3>
<p>Pops the topmost transaction on the redo stack, calls it's <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsITransaction#redoTransaction()">nsITransaction.redoTransaction()</a></code> method, then pushes it on the undo stack.</p>
<pre class="eval">void redoTransaction();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h3 id="RemoveListener()" name="RemoveListener()">RemoveListener()</h3>
<p>Removes a listener from the transaction manager's notification list. The listener's <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsITransactionListener#Release()">nsITransactionListener.Release()</a></code> method is called.</p>
<pre class="eval">void RemoveListener(
  in nsITransactionListener aListener
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aListener</code></dt> <dd>The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransactionListener" title="">nsITransactionListener</a></code> to remove.</dd>
</dl>
<h3 id="undoTransaction()" name="undoTransaction()">undoTransaction()</h3>
<p>Pops the topmost transaction on the undo stack, calls it's <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsITransaction#undoTransaction()">nsITransaction.undoTransaction()</a></code> method, then pushes it on the redo stack.</p>
<pre class="eval">void undoTransaction();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h2 id="See_also" name="See_also">See also</h2>
<ul> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransaction" title="">nsITransaction</a></code></li> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransactionList" title="">nsITransactionList</a></code></li> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransactionListener" title="">nsITransactionListener</a></code></li>
</ul></div><div id="footer"><hr/><p>This page was originally written for <a href="https://developer.mozilla.org">developer.mozilla.org</a> and is used here under the <a href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike license</a> (CC-BY-SA).</p>
<p>Original contributors to this page: <a href="https://developer.mozilla.org/en-US/profiles/wbamberg">wbamberg</a>, <a href="https://developer.mozilla.org/en-US/profiles/Sheppy">Sheppy</a>, <a href="https://developer.mozilla.org/en-US/profiles/trevorh">trevorh</a>, <a href="https://developer.mozilla.org/en-US/profiles/Wjjohnst">Wjjohnst</a>.</p></div></body>
</html>
