<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/zilla-slab.css"/>
    <link rel="stylesheet" href="/css/page.css"/>
    <title>nsILoginManagerStorage</title>
  </head>

  <body><nav class="breadcrumbs"><a href="../../../../../Mozilla.html">Mozilla</a>&raquo;<a href="../../../../Tech.html">Tech</a>&raquo;<a href="../../../XPCOM.html">XPCOM</a>&raquo;<a href="../../Reference.html">Reference</a>&raquo;<a href="../Interface.html">Interface</a></nav><div class="content-heading"><h1>nsILoginManagerStorage</h1></div>
<div class="content"><p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/toolkit/components/passwordmgr/public/nsILoginManagerStorage.idl" rel="custom">toolkit/components/passwordmgr/public/nsILoginManagerStorage.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

This interface is implemented by modules that wish to provide storage mechanisms for the Login Manager.
</span>

  <div style="height: 42px; position: relative; padding: 2px; width: auto;">

  <div style="top: 22px; font-size: 11px; position: absolute;">1.0</div>
  
  <div style="top: 22px; font-size: 11px; position: absolute; left: 0px; text-align: right; float: right; width: 100%;">66</div>
  
  <div style="height: 8px; top: 16px; background: #dd0000; left: 0px; position: absolute; width: 8.571428571428571%;"></div>
  
<div style="height: 8px; top: 16px; left: 8.571428571428571%; background: #00dd00; position: absolute; width: 91.42857142857143%;" title="Introduced in Gecko 1.9 (Firefox 3)"></div>

<div style="top: 0px; font-size: 11px; position: absolute; left: 8.571428571428571%;">Introduced</div>
<div style="top: 22px; font-size: 11px; position: absolute; left: 8.571428571428571%;">Gecko 1.9</div>

    <div style="height: 8px; top: 16px; left: 10.928571428571429%; background: #eeee00; position: absolute; width: 1%; border-radius: 4px; -webkit-border-radius: 4px;" title="Last changed in Gecko 2.0 (Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1)"></div>
    
</div>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 2.0 (Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1)</span></div>
</div><p></p>
<p>For example, if you wish to provide operating system integration with a native password manager system, implementing and registering a storage module for the Login Manager is how you do it. See <a href="/en/Creating_a_Login_Manager_storage_module" title="en/Creating_a_Login_Manager_storage_module">Creating a Login Manager storage module</a> for details.</p>
<div class="note"><strong>Note:</strong> Extensions that simply want to access/store logins should <a href="/en/XPCOM_Interface_Reference/nsILoginManager/Using_nsILoginManager" title="en/Using_nsILoginManager">use the Login Manager service</a> and <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsILoginManager" title="">nsILoginManager</a></code> interface instead. The Login Manager will handle selecting and using the correct <code>nsILoginManangerStorage</code> module.</div>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table"> <tbody> <tr> <td><code>void <a href="#addLogin()">addLogin</a>(in nsILoginInfo aLogin);</code></td> </tr> <tr> <td><code>unsigned long <a href="#countLogins()">countLogins</a>(in AString aHostname, in AString aActionURL, in AString aHttpRealm);</code></td> </tr> <tr> <td><code>void <a href="#findLogins()">findLogins</a>(out unsigned long count, in AString aHostname, in AString aActionURL, in AString aHttpRealm, [retval, array, size_is(count)] out nsILoginInfo logins);</code></td> </tr> <tr> <td><code>void <a href="#getAllDisabledHosts()">getAllDisabledHosts</a>([optional] out unsigned long count, [retval, array, size_is(count)] out wstring hostnames);</code></td> </tr> <tr> <td><code>void <a href="#getAllEncryptedLogins()">getAllEncryptedLogins</a>([optional] out unsigned long count, [retval, array, size_is(count)] out nsILoginInfo logins);</code> </td> </tr> <tr> <td><code>void <a href="#getAllLogins()">getAllLogins</a>([optional] out unsigned long count, [retval, array, size_is(count)] out nsILoginInfo logins);</code></td> </tr> <tr> <td><code>boolean <a href="#getLoginSavingEnabled()">getLoginSavingEnabled</a>(in AString aHost);</code></td> </tr> <tr> <td><code>void <a href="#init()">init</a>();</code></td> </tr> <tr> <td><code>void <a href="#initWithFile()">initWithFile</a>(in nsIFile aInputFile, in nsIFile aOutputFile);</code></td> </tr> <tr> <td><code>void <a href="#modifyLogin()">modifyLogin</a>(in nsILoginInfo oldLogin, in nsISupports newLoginData);</code></td> </tr> <tr> <td><code>void <a href="#removeAllLogins()">removeAllLogins</a>();</code></td> </tr> <tr> <td><code>void <a href="#removeLogin()">removeLogin</a>(in nsILoginInfo aLogin);</code></td> </tr> <tr> <td><code>void <a href="#searchLogins()">searchLogins</a>(out unsigned long count, in nsIPropertyBag matchData, [retval, array, size_is(count)] out nsILoginInfo logins);</code> </td> </tr> <tr> <td><code>void <a href="#setLoginSavingEnabled()">setLoginSavingEnabled</a>(in AString aHost, in boolean isEnabled);</code></td> </tr> </tbody>
</table>
<h2 id="Attributes" name="Attributes">Attributes</h2>
<table class="standard-table"> <tbody> <tr> <td class="header">Attribute</td> <td class="header">Type</td> <td class="header">Description</td> </tr> <tr> <td><code>uiBusy</code></td> <td><code><a href="/en/boolean" title="en/boolean">boolean</a></code></td> <td><code>true</code> when a master password prompt is being shown. <strong>Read only.</strong> </td> </tr> </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<h3 id="addLogin()" name="addLogin()">addLogin()</h3>
<p>Called by the Login Manager to store a new login.</p>
<p></p><div class="blockIndicator geckoMinVer standardNote">
  <div style="text-align: center; font-weight: bold; padding-bottom: 0.5em;">Gecko 1.9.1 note</div>
  <div>Default values for the <code>nsILoginMetaInfo</code> properties are created if the specified login doesn't explicitly specify them.</div>
</div><p></p>
<pre class="eval">void addLogin(
  in nsILoginInfo aLogin
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aLogin</code></dt> <dd>The login to add to the login storage.</dd>
</dl>
<h3 id="countLogins()" name="countLogins()">countLogins()</h3>
<p>Implement this method to return the number of logins matching the specified criteria. This method is called, for example, to check to see if there is a login that will match the criteria without having to ask the user for their master password in order to decrypt the logins.</p>
<pre class="eval">unsigned long countLogins(
  in AString aHostname,
  in AString aActionURL,
  in AString aHttpRealm
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aHostname</code></dt> <dd>The hostname to which to restrict the search. Specify an empty string to match all hosts. Passing <code>null</code> should not match any logins, and should return 0.</dd> <dt><code>aActionURL</code></dt> <dd>The URL of the form to which the login will be submitted. To match any form login, specify an empty string. To not match to any form login, specify <code>null</code>.</dd> <dt><code>aHttpRealm</code></dt> <dd>The HTTP realm for which the login applies. To match logins for any realm, specify an empty string. To not match any realm, specify <code>null</code>.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>The number of logins that match the specified criteria.</p>
<h3 id="findLogins()" name="findLogins()">findLogins()</h3>
<p>Implement this method to search the login store for logins matching the specified criteria. This method is called by the Login Manager when looking for saved logins that might apply to a form or authentication request.</p>
<pre class="eval">void findLogins(
  out unsigned long count,
  in AString aHostname,
  in AString aActionURL,
  in AString aHttpRealm,
  [retval, array, size_is(count)] out nsILoginInfo logins
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>count</code></dt> <dd>Return in this parameter the number of matching logins found by the search.</dd> <dt><code>aHostname</code></dt> <dd>The hostname to which to restrict the search. For example: "<a class=" external" href="http://www.site.com" rel="freelink">http://www.site.com</a>". Specify an empty string to match all hosts. Passing <code>null</code> should not match any logins, and should return a count of 0.</dd> <dt><code>aActionURL</code></dt> <dd>The URL of the form to which the login will be submitted. To match any form login, specify an empty string. To not match to any form login, specify <code>null</code>.</dd> <dt><code>aHttpRealm</code></dt> <dd>The HTTP realm for which the login applies. To match logins for any realm, specify an empty string. To not match any realm, specify <code>null</code>.</dd> <dt><code>logins</code></dt> <dd>Return in this parameter an array of <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsILoginInfo" title="">nsILoginInfo</a></code> matching the search criteria.</dd>
</dl>
<h3 id="getAllDisabledHosts()" name="getAllDisabledHosts()">getAllDisabledHosts()</h3>
<p>Implement this method to return a list of all hosts for which password saving is disabled.</p>
<pre class="eval">void getAllDisabledHosts(
  out unsigned long count, <span class="inlineIndicator optional optionalInline">Optional</span>
  [retval, array, size_is(count)] out wstring hostnames
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>count</code> <span class="inlineIndicator optional optionalInline">Optional</span></dt> <dd>Return in this parameter the number of disabled hostnames returned in the <code>hostnames</code> parameter.</dd> <dt><code>hostnames</code></dt> <dd>Return in this parameter an array of all hostnames for which password saving is disabled.</dd>
</dl>
<p></p><h3 id="getAllEncryptedLogins()">getAllEncryptedLogins()</h3><p></p>
<p>Fetch all logins in the login manager. An array is always returned; if there are no logins the array is empty. This does not decrypt logins before returning the array.</p>
<pre class="eval">void getAllEncryptedLogins(
  out unsigned long count, <span class="inlineIndicator optional optionalInline">Optional</span>
  [retval, array, size_is(count)] out nsILoginInfo logins
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>count</code> <span class="inlineIndicator optional optionalInline">Optional</span></dt> <dd>The number of elements in the array.</dd> <dt><code>logins</code></dt> <dd>An array of <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsILoginInfo" title="">nsILoginInfo</a></code> objects.</dd>
</dl>
<h3 id="getAllLogins()" name="getAllLogins()">getAllLogins()</h3>
<p>Implement this method to return a list of all logins in the login store.</p>
<pre class="eval">void getAllLogins(
  out unsigned long count, <span class="inlineIndicator optional optionalInline">Optional</span>
  [retval, array, size_is(count)] out nsILoginInfo logins
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>count</code> <span class="inlineIndicator optional optionalInline">Optional</span></dt> <dd>Return in this parameter the number of logins returned in the <code>logins</code> array.</dd> <dt><code>logins</code></dt> <dd>Return in this parameter an array of all <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsILoginInfo" title="">nsILoginInfo</a></code> objects in the login store. This parameter must always be an array; if there are no logins in the login store, it must be an empty array, <strong>not</strong> <code>null</code>.</dd>
</dl>
<h3 id="getLoginSavingEnabled()" name="getLoginSavingEnabled()">getLoginSavingEnabled()</h3>
<p>Implement to report whether or not login saving has been disabled for a specific host.</p>
<pre class="eval">boolean getLoginSavingEnabled(
  in AString aHost
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aHost</code></dt> <dd>The hostname whose login saving status should be returned. This string will be in the origin URL format, without a pathname. For example, <span class="nowiki">"http://mozilla.com"</span>.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Return <code>true</code> if login saving is enabled for the specified host; otherwise, return <code>false</code>.</p>
<h3 id="init()" name="init()">init()</h3>
<p>Implement this method to initialize the component. This is not called automatically; you must call it yourself if needed.</p>
<pre class="eval">void init();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h3 id="initWithFile()" name="initWithFile()">initWithFile()</h3>
<p>Implement this method to initialize the component, overriding the default filename locations with those specified. This method is primarily used for unit tests and during profile migration.</p>
<pre class="eval">void initWithFile(
  in nsIFile aInputFile,
  in nsIFile aOutputFile
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aInputFile</code></dt> <dd>The file from which to read stored logins.</dd> <dt><code>aOutputFile</code></dt> <dd>The file to which to write stored logins, if not <code>null</code>. If this is <code>null</code>, use the default output file.</dd>
</dl>
<h3 id="modifyLogin()" name="modifyLogin()">modifyLogin()</h3>
<p>Implement this method to modify an existing login in the login store.</p>
<p>If <code>newLoginData</code> is specified as an <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsILoginInfo" title="">nsILoginInfo</a></code> object, all of the old login's properties are changed to the values from the <code>newLoginData</code> parameter. If <code>newLoginData</code> is a <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIPropertyBag" title="">nsIPropertyBag</a></code>, only the properties specified in the <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIPropertyBag" title="">nsIPropertyBag</a></code> are changed in <code>oldLogin</code> and its corresponding <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsILoginMetaInfo" title="">nsILoginMetaInfo</a></code>.</p>
<pre class="eval">void modifyLogin(
  in nsILoginInfo oldLogin,
  in nsISupports newLoginData
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>oldLogin</code></dt> <dd>The login to be modified.</dd> <dt><code>newLoginData</code></dt> <dd>The login information to replace the <code>oldLogin</code> with. This may be specified as either an <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsILoginInfo" title="">nsILoginInfo</a></code> or an <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIPropertyBag2" title="">nsIPropertyBag2</a></code> object.</dd>
</dl>
<h3 id="removeAllLogins()" name="removeAllLogins()">removeAllLogins()</h3>
<p>Implement this method to remove all logins from the login store. This is called by the browser sanitization feature when the user asks to clear all stored passwords. The user interface allows this to be done without getting each login first (which might require knowing the master password). No password should be required in order to remove all logins.</p>
<pre class="eval">void removeAllLogins();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h3 id="removeLogin()" name="removeLogin()">removeLogin()</h3>
<p>Implement this method to remove the specified login from the login store.</p>
<p></p><div class="blockIndicator geckoMinVer standardNote">
  <div style="text-align: center; font-weight: bold; padding-bottom: 0.5em;">Gecko 1.9.1 note</div>
  <div>The values of any <code>nsILoginMetaInfo</code> properties are ignored.</div>
</div><p></p>
<pre class="eval">void removeLogin(
  in nsILoginInfo aLogin
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aLogin</code></dt> <dd>The login to remove from the login store. A login must match completely (except for its <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsILoginMetaInfo" title="">nsILoginMetaInfo</a></code> data) to be removed.</dd>
</dl>
<p></p><h3 id="searchLogins()">searchLogins()</h3><p></p>
<p>Implement this to search for logins in the login manager's data store, returning an array of matching logins. If there are no matching logins, return an empty array.</p>
<pre class="eval">void searchLogins(
  out unsigned long count,
  in nsIPropertyBag matchData,
  [retval, array, size_is(count)] out nsILoginInfo logins
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>count</code></dt> <dd>The number of elements in the logins array.</dd> <dt><code>matchData</code></dt> <dd>The data used for the search. This does not follow the same requirements as <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsILoginManagerStorage#findLogins()">findLogins()</a></code> for those fields; wildcard matches are not specified.</dd> <dt><code>logins</code></dt> <dd>An array of matching <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsILoginInfo" title="">nsILoginInfo</a></code> objects.</dd>
</dl>
<h3 id="setLoginSavingEnabled()" name="setLoginSavingEnabled()">setLoginSavingEnabled()</h3>
<p>Implement this method to enable or disable login saving for the specified host. When login saving is disabled for a host, the Login Manager will not propt the user for permission to store logins for that host. Existing logins for the host should not be affected when setting this.</p>
<pre class="eval">void setLoginSavingEnabled(
  in AString aHost,
  in boolean isEnabled
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aHost</code></dt> <dd>The host for which to enable or disable login saving. The argument is in origin URL format, without a pathname (for example: <span class="nowiki">"http://mozilla.com"</span>).</dd> <dt><code>isEnabled</code></dt> <dd><code>true</code> if logins should be enabled for the host, or <code>false</code> if they should be disabled.</dd>
</dl>
<h2 id="Remarks" name="Remarks">Remarks</h2>
<p>For methods returning count, JavaScript callers can simply use the <code>length</code> property on the returned array to find out how many logins were returned in the array, for example:</p>
<pre class="brush: js">var logins = pwmgr.searchLogins({}, matchData);
var numLogins = logins.length;</pre>
<h2 id="See_also" name="See_also">See also</h2>
<ul> <li><a href="/en/Creating_a_Login_Manager_storage_module" title="en/Creating_a_Login_Manager_storage_module">Creating a Login Manager storage module</a></li> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsILoginManager" title="">nsILoginManager</a></code></li>
</ul></div><div id="footer"><hr/><p>This page was originally written for <a href="https://developer.mozilla.org">developer.mozilla.org</a> and is used here under the <a href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike license</a> (CC-BY-SA).</p>
<p>Original contributors to this page: <a href="https://developer.mozilla.org/en-US/profiles/wbamberg">wbamberg</a>, <a href="https://developer.mozilla.org/en-US/profiles/Sheppy">Sheppy</a>, <a href="https://developer.mozilla.org/en-US/profiles/trevorh">trevorh</a>, <a href="https://developer.mozilla.org/en-US/profiles/Dolske">Dolske</a>, <a href="https://developer.mozilla.org/en-US/profiles/Callek">Callek</a>.</p></div></body>
</html>
