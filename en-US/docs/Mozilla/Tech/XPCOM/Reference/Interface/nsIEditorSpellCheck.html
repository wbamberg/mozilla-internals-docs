<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/zilla-slab.css"/>
    <link rel="stylesheet" href="/css/page.css"/>
    <title>nsIEditorSpellCheck</title>
  </head>

  <body><div class="content-heading"><h1>nsIEditorSpellCheck</h1></div>
<div class="content"><p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/editor/idl/nsIEditorSpellCheck.idl" rel="custom">editor/idl/nsIEditorSpellCheck.idl</a></code><span style="text-align: right; float: right;"><span style="color: #cc0000; font-weight: 700;">Not scriptable</span></span></div>
<span style="padding: 4px 2px;">Provides spell checking commands for <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIEditor" title="">nsIEditor</a></code> instances.</span>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 9.0 (Firefox 9.0 / Thunderbird 9.0 / SeaMonkey 2.6)</span></div>
</div><p></p>
<p>Implemented by: <code>@mozilla.org/editor/editorspellchecker;1</code>. To create an instance, use:</p>
<pre class="eval">var editorSpellCheck = Components.classes["<code>@mozilla.org/editor/editorspellchecker;1</code>"]
                       .createInstance(Components.interfaces.nsIEditorSpellCheck);
</pre>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table">
 <tbody>
  <tr>
   <td><code>void <a href="#AddWordToDictionary()">AddWordToDictionary</a>(in wstring word);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#canSpellCheck()">canSpellCheck</a>();</code> </td>
  </tr>
  <tr>
   <td><code>void <a href="#checkCurrentDictionary()">checkCurrentDictionary</a>();</code> </td>
  </tr>
  <tr>
   <td><code>boolean <a href="#CheckCurrentWord()">CheckCurrentWord</a>(in wstring suggestedWord);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#CheckCurrentWordNoSuggest()">CheckCurrentWordNoSuggest</a>(in wstring suggestedWord);</code> </td>
  </tr>
  <tr>
   <td><code>AString <a href="#GetCurrentDictionary()">GetCurrentDictionary</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#GetDictionaryList()">GetDictionaryList</a>([array, size_is(count)] out wstring dictionaryList, out PRUint32 count);</code></td>
  </tr>
  <tr>
   <td><code>wstring <a href="#GetNextMisspelledWord()">GetNextMisspelledWord</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#GetPersonalDictionary()">GetPersonalDictionary</a>();</code></td>
  </tr>
  <tr>
   <td><code>wstring <a href="#GetPersonalDictionaryWord()">GetPersonalDictionaryWord</a>();</code></td>
  </tr>
  <tr>
   <td><code>wstring <a href="#GetSuggestedWord()">GetSuggestedWord</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#IgnoreWordAllOccurrences()">IgnoreWordAllOccurrences</a>(in wstring word);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#InitSpellChecker()">InitSpellChecker</a>(in nsIEditor editor, in boolean enableSelectionChecking);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#RemoveWordFromDictionary()">RemoveWordFromDictionary</a>(in wstring word);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#ReplaceWord()">ReplaceWord</a>(in wstring misspelledWord, in wstring replaceWord, in boolean allOccurrences);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#saveDefaultDictionary()">saveDefaultDictionary</a>();</code>  <span class="inlineIndicator obsolete obsoleteInline" title="(Firefox 9.0 / Thunderbird 9.0 / SeaMonkey 2.6)">Obsolete since Gecko 9.0</span></td>
  </tr>
  <tr>
   <td><code>void <a href="#SetCurrentDictionary()">SetCurrentDictionary</a>(in AString dictionary);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#setFilter()">setFilter</a>(in nsITextServicesFilter filter);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#UninitSpellChecker()">UninitSpellChecker</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#UpdateCurrentDictionary()">UpdateCurrentDictionary</a>();</code></td>
  </tr>
 </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<h3 id="AddWordToDictionary()" name="AddWordToDictionary()">AddWordToDictionary()</h3>
<p>Adds the specified word to the current personal dictionary.</p>
<pre class="eval">void AddWordToDictionary(
  in wstring word
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>word</code></dt>
 <dd>
  The word to add to the current personal dictionary.</dd>
</dl>
<p></p><h3 id="canSpellCheck()">canSpellCheck()</h3><p></p>
<p>Determines whether or not spell checking can be enabled.</p>
<pre class="eval">boolean canSpellCheck();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Returns <code>true</code> if spell checking can be enabled. If there are no available dictionaries, the return value isÂ <code>false</code>.</p>
<p></p><h3 id="checkCurrentDictionary()">checkCurrentDictionary()</h3><p></p>
<p>Call this after any change in installed dictionaries to ensure that the spell checker is not using a current dictionary which is no longer available. If the current dictionary is no longer available, pick another dictionary.</p>
<pre class="eval">void checkCurrentDictionary();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h3 id="CheckCurrentWord()" name="CheckCurrentWord()">CheckCurrentWord()</h3>
<p>Checks a given word. In spite of the name, this function checks the word you give it, returning <code>true</code> if the word is misspelled. If the word is misspelled, it will compute the suggestions which you can get from <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIEditorSpellCheck#GetSuggestedWord()">GetSuggestedWord()</a></code>.</p>
<pre class="eval">boolean CheckCurrentWord(
  in wstring suggestedWord
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>suggestedWord</code></dt>
 <dd>
  Missing Description</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p><code>true</code> if the specified word is misspelled; otherwise <code>false</code>.</p>
<p></p><h3 id="CheckCurrentWordNoSuggest()">CheckCurrentWordNoSuggest()</h3><p></p>
<p>Like <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIEditorSpellCheck#CheckCurrentWord()">CheckCurrentWord()</a></code>, checks the word you give it, returning <code>true</code> if it is misspelled. This is faster than <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIEditorSpellCheck#CheckCurrentWord()">CheckCurrentWord()</a></code> because it does not compute any suggestions.</p>
<div class="note">
 <strong>Note:</strong> This does not clear any suggestions left over from previous calls to <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIEditorSpellCheck#CheckCurrentWord()">CheckCurrentWord()</a></code>, so there may be suggestions, but they will be invalid.</div>
<pre class="eval">boolean CheckCurrentWordNoSuggest(
  in wstring suggestedWord
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>suggestedWord</code></dt>
 <dd>
  The word to check.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p><code>true</code> if the word is misspelled; otherwise <code>false</code>.</p>
<h3 id="GetCurrentDictionary()" name="GetCurrentDictionary()">GetCurrentDictionary()</h3>
<p>Returns the name of the dictionary currently in use.</p>
<pre class="eval">AString GetCurrentDictionary();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>The name of the dictionary currently in use. Typically, this is an ISO language code, such as "en-US".</p>
<h3 id="GetDictionaryList()" name="GetDictionaryList()">GetDictionaryList()</h3>
<p>Retrieves a list of the currently available dictionaries. The strings will typically be language IDs, such as "en-US".</p>
<pre class="eval">void GetDictionaryList(
  [array, size_is(count)] out wstring dictionaryList,
  out PRUint32 count
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>dictionaryList</code></dt>
 <dd>
  An array into which the list of dictionary name strings are placed.</dd>
 <dt>
  <code>count</code></dt>
 <dd>
  On return, contains the number of entries in the <code>dictionaryList</code> array.</dd>
</dl>
<h3 id="GetNextMisspelledWord()" name="GetNextMisspelledWord()">GetNextMisspelledWord()</h3>
<p>When interactively spell checking the document, this will return the value of the next word that is misspelled. This also computes the suggestions which you can get by calling <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIEditorSpellCheck#GetSuggestedWord()">GetSuggestedWord()</a></code>.</p>
<pre class="eval">wstring GetNextMisspelledWord();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>The next misspelled word in the document.</p>
<h3 id="GetPersonalDictionary()" name="GetPersonalDictionary()">GetPersonalDictionary()</h3>
<p>Fills an internal list of words added to the personal dictionary. These words can be retrieved using <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIEditorSpellCheck#GetPersonalDictionaryWord()">GetPersonalDictionaryWord()</a></code></p>
<pre class="eval">void GetPersonalDictionary();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h3 id="GetPersonalDictionaryWord()" name="GetPersonalDictionaryWord()">GetPersonalDictionaryWord()</h3>
<p>Used after you call <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIEditorSpellCheck#GetPersonalDictionary()">GetPersonalDictionary()</a></code> to iterate through all the words added to the personal dictionary. Returns an empty string when there are no more words.</p>
<pre class="eval">wstring GetPersonalDictionaryWord();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>The next word in the personal dictionary.</p>
<h3 id="GetSuggestedWord()" name="GetSuggestedWord()">GetSuggestedWord()</h3>
<p>Used to get suggestions for the last word that was checked and was misspelled. The first call returns the first (best) suggestion. Subsequent calls iterate through all suggestions, allowing you to build a list. When there are no more suggestions, an empty string (not a <code>null</code> pointer) is returned.</p>
<pre class="eval">wstring GetSuggestedWord();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>The next best suggestion for the last word that was checked and was misspelled, or an empty string if there are no remaining suggestions.</p>
<h3 id="IgnoreWordAllOccurrences()" name="IgnoreWordAllOccurrences()">IgnoreWordAllOccurrences()</h3>
<p>Tells the spell checker to ignore all occurrences of the specified word when spell checking the document.</p>
<pre class="eval">void IgnoreWordAllOccurrences(
  in wstring word
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>word</code></dt>
 <dd>
  The word to ignore when spell checking.</dd>
</dl>
<h3 id="InitSpellChecker()" name="InitSpellChecker()">InitSpellChecker()</h3>
<p>Turns on the spell checker for the given editor.</p>
<pre class="eval">void InitSpellChecker(
  in nsIEditor editor,
  in boolean enableSelectionChecking
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>editor</code></dt>
 <dd>
  The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIEditor" title="">nsIEditor</a></code> on which to enable spell checking.</dd>
 <dt>
  <code>enableSelectionChecking</code></dt>
 <dd>
  If true, the spell checker is initialized only for checking the current selection; otherwise, it's initialized for checking the entire document. This affects the behavior of <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIEditorSpellCheck#GetNextMisspelledWord()">GetNextMisspelledWord()</a></code>). For spell checking clients with no modal UI (such as inline spell checkers), this flag is not relevant.</dd>
</dl>
<h3 id="RemoveWordFromDictionary()" name="RemoveWordFromDictionary()">RemoveWordFromDictionary()</h3>
<p>Removes a word from the current personal dictionary.</p>
<pre class="eval">void RemoveWordFromDictionary(
  in wstring word
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>word</code></dt>
 <dd>
  The word to remove from the current personal dictionary.</dd>
</dl>
<h3 id="ReplaceWord()" name="ReplaceWord()">ReplaceWord()</h3>
<p>Call this function to modally replace one (or all) occurrences of a word with another word.</p>
<pre class="eval">void ReplaceWord(
  in wstring misspelledWord,
  in wstring replaceWord,
  in boolean allOccurrences
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>misspelledWord</code></dt>
 <dd>
  The word to replace.</dd>
 <dt>
  <code>replaceWord</code></dt>
 <dd>
  The word with which to replace the <code>misspelledWord</code>.</dd>
 <dt>
  <code>allOccurrences</code></dt>
 <dd>
  If <code>true</code>, all occurrences of <code>misspelledWord</code> are replaced with <code>replaceWord</code>. If <code>false</code>, only the first occurrence is replaced.</dd>
</dl>
<p></p><h3 id="saveDefaultDictionary()">saveDefaultDictionary()</h3><p></p>
<p></p><div class="blockIndicator obsolete obsoleteHeader"><p><strong><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span> Obsolete since Gecko 9.0 (Firefox 9.0 / Thunderbird 9.0 / SeaMonkey 2.6)</strong><br>This feature is obsolete. Although it may still work in some browsers, its use is discouraged since it could be removed at any time. Try to avoid using it.</p></div><p></p>
<p>Saves the currently selected dictionary as the default. The function <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIEditorSpellCheck#UninitSpellChecker()">UninitSpellChecker()</a></code> will also do this, but that function may not be called in some situations. This function allows the caller to force the default immediately.</p>
<div class="note">
 <strong>Note:</strong> This method was removed in Gecko 9.0 (Firefox 9.0 / Thunderbird 9.0 / SeaMonkey 2.6). Since spelling dictionaries can now be selected per-site, this method is no longer needed.</div>
<pre class="eval">void saveDefaultDictionary();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h3 id="SetCurrentDictionary()" name="SetCurrentDictionary()">SetCurrentDictionary()</h3>
<p>Selects the main dictionary to use.</p>
<pre class="eval">void SetCurrentDictionary(
  in AString dictionary
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>dictionary</code></dt>
 <dd>
  The name of the dictionary to use. Typically, this is an ISO language code such as "en-US".</dd>
</dl>
<h3 id="setFilter()" name="setFilter()">setFilter()</h3>
<p>Used to filter the content (for example, to skip blockquotes in email from spell checking). Call this before calling <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIEditorSpellCheck#InitSpellChecker()">InitSpellChecker()</a></code>; calling it after initialization will have no effect.</p>
<pre class="eval">void setFilter(
  in nsITextServicesFilter filter
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>filter</code></dt>
 <dd>
  An <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITextServicesFilter" title="">nsITextServicesFilter</a></code> describing the filter to apply. This filter lets you avoid spell checking specific parts of the document.</dd>
</dl>
<h3 id="UninitSpellChecker()" name="UninitSpellChecker()">UninitSpellChecker()</h3>
<p>Call this to release the spell checking object. It will also save the current selected language as the default for future use.</p>
<p>If you have called <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIEditorSpellCheck#CanSpellCheck()">CanSpellCheck()</a></code> but not <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIEditorSpellCheck#InitSpellChecker()">InitSpellChecker()</a></code>, you can still call this function to clear the cached spell check object, and no preferences are saved.</p>
<pre class="eval">void UninitSpellChecker();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h3 id="UpdateCurrentDictionary()">UpdateCurrentDictionary()</h3>
<p>Updates the dictionary in use to be sure it corresponds to what the editor needs.</p>
<pre class="eval">void UpdateCurrentDictionary();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h6 id="Remarks">Remarks</h6>
<p>Prior to Gecko 9.0 (Firefox 9.0 / Thunderbird 9.0 / SeaMonkey 2.6), this method took one parameter, a reference to the <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIEditor" title="">nsIEditor</a></code> for which to update the spell checker. Now that spell checker settings are per-site, this method takes no parameters.</p></div><div id="footer"><hr/><p>This page was originally written for <a href="https://developer.mozilla.org">developer.mozilla.org</a> and is used here under the <a href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike license</a> (CC-BY-SA).</p>
<p>Original contributors to this page: <a href="https://developer.mozilla.org/en-US/profiles/wbamberg">wbamberg</a>, <a href="https://developer.mozilla.org/en-US/profiles/mdnwebdocs-bot">mdnwebdocs-bot</a>, <a href="https://developer.mozilla.org/en-US/profiles/Sheppy">Sheppy</a>, <a href="https://developer.mozilla.org/en-US/profiles/amycb">amycb</a>, <a href="https://developer.mozilla.org/en-US/profiles/kscarfone">kscarfone</a>.</p></div></body>
</html>
