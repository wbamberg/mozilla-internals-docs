<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/zilla-slab.css"/>
    <link rel="stylesheet" href="/css/page.css"/>
    <title>nsICookiePermission</title>
  </head>

  <body><nav class="breadcrumbs"><a href="../../../../../Mozilla.html">Mozilla</a>&raquo;<a href="../../../../Tech.html">Tech</a>&raquo;<a href="../../../XPCOM.html">XPCOM</a>&raquo;<a href="../../Reference.html">Reference</a>&raquo;<a href="../Interface.html">Interface</a></nav><div class="content-heading"><h1>nsICookiePermission</h1></div>
<div class="content"><p>The <code>nsICookiePermission</code> interface is used to test for cookie permissions</p>
<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/netwerk/cookie/nsICookiePermission.idl" rel="custom">netwerk/cookie/nsICookiePermission.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

<i>Please add a summary to this article.</i>
</span>

<div style="background: #eee; padding: 2px;">
<span>Â </span>
<span style="text-align: right; float: right;">Last changed in Gecko 1.9 (Firefox 3)</span></div>
</div><p></p>
<p>Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code></p>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table"> <tbody> <tr> <td><code>nsCookieAccess <a href="#canAccess()">canAccess</a>(in nsIURI aURI, in nsIChannel aChannel);</code></td> </tr> <tr> <td><code>boolean <a href="#canSetCookie()">canSetCookie</a>(in nsIURI aURI, in nsIChannel aChannel, in nsICookie2 aCookie, inout boolean aIsSession, inout PRInt64 aExpiry);</code></td> </tr> <tr> <td><code>nsIURI <a href="#getOriginatingURI()">getOriginatingURI</a>(in nsIChannel aChannel);</code> </td> </tr> <tr> <td><code>void <a href="#setAccess()">setAccess</a>(in nsIURI aURI, in nsCookieAccess aAccess);</code></td> </tr> </tbody>
</table>
<h2 id="Constants" name="Constants">Constants</h2>
<table class="standard-table"> <tbody> <tr> <td class="header">Constant</td> <td class="header">Value</td> <td class="header">Description</td> </tr> <tr> <td><code>ACCESS_DEFAULT</code></td> <td><code>0</code></td> <td><code>nsCookieAccess</code>'s access default value</td> </tr> <tr> <td><code>ACCESS_ALLOW</code></td> <td><code>1</code></td> <td><code>nsCookieAccess</code>'s access allow value</td> </tr> <tr> <td><code>ACCESS_DENY</code></td> <td><code>2</code></td> <td><code>nsCookieAccess</code>'s access deny value</td> </tr> <tr> <td><code>ACCESS_SESSION</code></td> <td><code>8</code></td> <td>Additional values for <code>nsCookieAccess</code>, which are not directly used by any methods on this interface, but are nevertheless convenient to define here. These may be relocated somewhere else if we ever consider freezing this interface.</td> </tr> </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<h3 id="canAccess()" name="canAccess()">canAccess()</h3>
<p>Tests whether or not the given URI/channel may access the cookie database, either to set or get cookies.</p>
<pre class="eval">nsCookieAccess canAccess(
  in nsIURI aURI,
  in nsIURI aFirstURI, <span class="inlineIndicator obsolete obsoleteInline" title="(Firefox 3)">Obsolete since Gecko 1.9</span>
  in nsIChannel aChannel
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aURI</code></dt> <dd>The URI trying to access cookies.</dd> <dt><code>aFirstURI</code></dt> <dd>The URI initiated by the user that resulted in <code>aURI</code> being loaded.</dd> <dt><code>aChannel</code></dt> <dd>The channel corresponding to <code>aURI</code>.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>One of the <code>nsCookieAccess</code> values: <code>ACCESS_DEFAULT</code>, <code>ACCESS_ALLOW</code>, or <code>ACCESS_DENY</code>.</p>
<h3 id="canSetCookie()" name="canSetCookie()">canSetCookie()</h3>
<p>Tests whether or not the given URI/channel may set a specific cookie. This method is always preceded by a call to <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsICookiePermission#canAccess()">canAccess()</a></code>. It may modify the <code>isSession</code> and <code>expiry</code> attributes of the cookie via the <code>aIsSession</code> and <code>aExpiry</code> parameters, in order to limit or extend the lifetime of the cookie. This is useful, for instance, to downgrade a cookie to session-only if it fails to meet certain criteria.</p>
<pre class="eval">boolean canSetCookie(
  in nsIURI aURI,
  in nsIChannel aChannel,
  in nsICookie2 aCookie,
  inout boolean aIsSession,
  inout PRInt64 aExpiry
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aURI</code></dt> <dd>The URI trying to set the cookie.</dd> <dt><code>aChannel</code></dt> <dd>The channel corresponding to <code>aURI</code>.</dd> <dt><code>aCookie</code></dt> <dd>The cookie being added to the cookie database.</dd> <dt><code>aIsSession</code></dt> <dd>When <code>canSetCookie</code> is invoked, this is the current <code>isSession</code> attribute of the cookie. <code>canSetCookie</code> may leave this value unchanged to preserve this attribute of the cookie.</dd> <dt><code>aExpiry</code></dt> <dd>When <code>canSetCookie</code> is invoked, this is the current expiry time of the cookie. <code>canSetCookie</code> may leave this value unchanged to preserve this attribute of the cookie.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p><code>true</code> if the cookie can be set.</p>
<p></p><h3 id="getOriginatingURI()">getOriginatingURI()</h3><p></p>
<p>Determines the originating URI for a load given a channel, for third-party cookie blocking. This is done by leveraging the loadgroup of the channel to find the root content docshell, and the URI associated with its principal. If the root content docshell or its principal's URI cannot be obtained, this method will throw.</p>
<pre class="eval">nsIURI getOriginatingURI(
  in nsIChannel aChannel
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aChannel</code></dt> <dd>The channel for the load trying to get or set cookies.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>The originating URI.</p>
<h3 id="setAccess()" name="setAccess()">setAccess()</h3>
<p>Sets cookie access permissions for the given URI. This may result in other URIs being blocked as well, such as URIs that share the same host name.</p>
<pre class="eval">void setAccess(
  in nsIURI aURI,
  in nsCookieAccess aAccess
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aURI</code></dt> <dd>The URI to block.</dd> <dt><code>aAccess</code></dt> <dd>The new cookie access permissions for the URI.</dd>
</dl>
<h2 id="See_also" name="See_also">See also</h2>
<ul> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsICookie" title="">nsICookie</a></code></li> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsICookie2" title="">nsICookie2</a></code></li> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsICookieManager" title="">nsICookieManager</a></code></li> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsICookieManager2" title="">nsICookieManager2</a></code></li>
</ul></div><div id="footer"><hr/><p>This page was originally written for <a href="https://developer.mozilla.org">developer.mozilla.org</a> and is used here under the <a href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike license</a> (CC-BY-SA).</p>
<p>Original contributors to this page: <a href="https://developer.mozilla.org/en-US/profiles/wbamberg">wbamberg</a>, <a href="https://developer.mozilla.org/en-US/profiles/Sheppy">Sheppy</a>, <a href="https://developer.mozilla.org/en-US/profiles/trevorh">trevorh</a>, <a href="https://developer.mozilla.org/en-US/profiles/Ayhfung">Ayhfung</a>.</p></div></body>
</html>
