<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/zilla-slab.css"/>
    <link rel="stylesheet" href="/css/page.css"/>
    <title>nsICacheEntryDescriptor</title>
  </head>

  <body><div class="content-heading"><h1>nsICacheEntryDescriptor</h1></div>
<div class="content"><p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/netwerk/cache/nsICacheEntryDescriptor.idl" rel="custom">netwerk/cache/nsICacheEntryDescriptor.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

This interface provides a cache entry descriptor.
</span>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsICacheEntryInfo" title="">nsICacheEntryInfo</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 2.0 (Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1)</span></div>
</div><p></p>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table"> <tbody> <tr> <td><code>void <a href="#close()">close</a>();</code></td> </tr> <tr> <td><code>void <a href="#doom()">doom</a>();</code></td> </tr> <tr> <td><code>void <a href="#doomAndFailPendingRequests()">doomAndFailPendingRequests</a>(in nsresult status);</code></td> </tr> <tr> <td><code>string <a href="#getMetaDataElement()">getMetaDataElement</a>(in string key);</code></td> </tr> <tr> <td><code>void <a href="#markValid()">markValid</a>();</code></td> </tr> <tr> <td><code>nsIInputStream <a href="#openInputStream()">openInputStream</a>(in unsigned long offset);</code></td> </tr> <tr> <td><code>nsIOutputStream <a href="#openOutputStream()">openOutputStream</a>(in unsigned long offset);</code></td> </tr> <tr> <td><code>void <a href="#setDataSize()">setDataSize</a>(in unsigned long size);</code></td> </tr> <tr> <td><code>void <a href="#setExpirationTime()">setExpirationTime</a>(in PRUint32 expirationTime);</code></td> </tr> <tr> <td><code>void <a href="#setMetaDataElement()">setMetaDataElement</a>(in string key, in string value);</code></td> </tr> <tr> <td><code>void <a href="#visitMetaData()">visitMetaData</a>(in nsICacheMetaDataVisitor visitor);</code></td> </tr> </tbody>
</table>
<h2 id="Attributes" name="Attributes">Attributes</h2>
<table class="standard-table"> <tbody> <tr> <td class="header">Attribute</td> <td class="header">Type</td> <td class="header">Description</td> </tr> <tr> <td><code>accessGranted</code></td> <td><code><a href="/en/nsCacheAccessMode" title="en/nsCacheAccessMode">nsCacheAccessMode</a></code></td> <td>Get the access granted to this descriptor. See <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsICache" title="">nsICache</a></code> for the definitions of the access modes and a thorough description of their corresponding meanings. <strong>Read only.</strong></td> </tr> <tr> <td><code>cacheElement</code></td> <td><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code></td> <td>Get or set the cache data element. This will fail if the cache entry <strong>is</strong> stream based. The cache entry holds a strong reference to this object. The object will be released when the cache entry is destroyed.</td> </tr> <tr> <td><code>file</code></td> <td><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIFile" title="">nsIFile</a></code></td> <td>Get the disk file associated with the cache entry. <strong>Read only.</strong></td> </tr> <tr> <td><code>predictedDataSize</code></td> <td><code><a href="/en/PRInt64" title="en/PRInt64">PRInt64</a></code></td> <td>Stores the Content-Length specified in the HTTP header for this entry. Checked before we write to the cache entry, to prevent ever taking up space in the cache for an entry that we know up front is going to have to be evicted anyway. See <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=588507" title="FIXED: Skip caching if Content-length > eviction size">bugÂ 588507</a>. </td> </tr> <tr> <td><code>securityInfo</code></td> <td><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code></td> <td>Get or set security info on the cache entry for this descriptor. This fails if the storage policy is not <code>STORE_IN_MEMORY</code>.</td> </tr> <tr> <td><code>storagePolicy</code></td> <td><code><a href="/en/nsCacheStoragePolicy" title="en/nsCacheStoragePolicy">nsCacheStoragePolicy</a></code></td> <td>Get or set the storage policy of the cache entry. See <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsICache" title="">nsICache</a></code> for the definitions of the storage policies.</td> </tr> </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<h3 id="close()" name="close()">close()</h3>
<p>This method explicitly closes the descriptor (optional).</p>
<pre class="eval">void close();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h3 id="doom()" name="doom()">doom()</h3>
<p>This method dooms the cache entry this descriptor references in order to slate it for removal. Once doomed a cache entry cannot be undoomed.</p>
<p>A descriptor with WRITE access can doom the cache entry and choose to fail pending requests. This means that pending requests will not get a cache descriptor. This is meant as a tool for clients that wish to instruct pending requests to skip the cache.</p>
<pre class="eval">void doom();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h3 id="doomAndFailPendingRequests()" name="doomAndFailPendingRequests()">doomAndFailPendingRequests()</h3>
<p>This method with the <code>WRITE</code> access can doom the cache entry and choose to fail pending requests. This means that pending requests will not get a cache descriptor. This is meant as a tool for clients that wish to instruct pending requests to skip the cache.</p>
<pre class="eval">void doomAndFailPendingRequests(
  in nsresult status
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>status</code></dt> <dd>The access status.</dd>
</dl>
<h3 id="getMetaDataElement()" name="getMetaDataElement()">getMetaDataElement()</h3>
<p>This method retrieves the meta data. Meta data is a table of key/value string pairs. The strings do not have to conform to any particular charset, but they must be <code>null</code> terminated.</p>
<pre class="eval">string getMetaDataElement(
  in string key
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>key</code></dt> <dd>The key for retrieving the meta data.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Returns the string value containing the meta data for the provided key.</p>
<h3 id="markValid()" name="markValid()">markValid()</h3>
<p>This method means that a writer must validate this cache object before any readers are given a descriptor to the object.</p>
<pre class="eval">void markValid();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h3 id="openInputStream()" name="openInputStream()">openInputStream()</h3>
<p>This method opens blocking input stream to cache data. This will fail if the cache entry <strong>is not</strong> stream based. Use the stream transport service to asynchronously read this stream on a background thread. The returned stream <strong>may</strong> implement <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISeekableStream" title="">nsISeekableStream</a></code>.</p>
<pre class="eval">nsIInputStream openInputStream(
  in unsigned long offset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>offset</code></dt> <dd>Read starting from this offset into the cached data. An offset beyond the end of the stream has undefined consequences.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Returns blocking, unbuffered input stream.</p>
<h3 id="openOutputStream()" name="openOutputStream()">openOutputStream()</h3>
<p>This method opens blocking output stream to cache data. This will fail if the cache entry <strong>is not</strong> stream based. Use the stream transport service to asynchronously write to this stream on a background thread. The returned stream <strong>may</strong> implement <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISeekableStream" title="">nsISeekableStream</a></code>.</p>
<p>If opening an output stream to existing cached data, the data will be truncated to the specified offset.</p>
<pre class="eval">nsIOutputStream openOutputStream(
  in unsigned long offset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>offset</code></dt> <dd>Write starting from this offset into the cached data. An offset beyond the end of the stream has undefined consequences.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Returns blocking, unbuffered output stream.</p>
<h3 id="setDataSize()" name="setDataSize()">setDataSize()</h3>
<p>This method sets the cache entry data size. This will fail if the cache entry <strong>is</strong> stream based.</p>
<pre class="eval">void setDataSize(
  in unsigned long size
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>size</code></dt> <dd>The cache entry data size.</dd>
</dl>
<h3 id="setExpirationTime()" name="setExpirationTime()">setExpirationTime()</h3>
<p>This method sets the time at which the cache entry should be considered invalid (in seconds since the Epoch).</p>
<pre class="eval">void setExpirationTime(
  in PRUint32 expirationTime
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>expirationTime</code></dt> <dd>The time for cache entry expiration (in seconds).</dd>
</dl>
<h3 id="setMetaDataElement()" name="setMetaDataElement()">setMetaDataElement()</h3>
<p>This method sets the meta data. Meta data is a table of key/value string pairs. The strings do not have to conform to any particular charset, but they must be <code>null</code> terminated.</p>
<pre class="eval">void setMetaDataElement(
  in string key,
  in string value
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>key</code></dt> <dd>The key for setting the meta data.</dd> <dt><code>value</code></dt> <dd>The value for setting the meta data.</dd>
</dl>
<h3 id="visitMetaData()" name="visitMetaData()">visitMetaData()</h3>
<p>This method means that the visitor will be called with key/value pair for each meta data element.</p>
<pre class="eval">void visitMetaData(
  in nsICacheMetaDataVisitor visitor
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>visitor</code></dt> <dd>The visitor to be called.</dd>
</dl>
<h2 id="See_also" name="See_also">See also</h2>
<ul> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsICacheVisitor" title="">nsICacheVisitor</a></code></li> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsICache" title="">nsICache</a></code></li> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISimpleEnumerator" title="">nsISimpleEnumerator</a></code></li> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsICacheListener" title="">nsICacheListener</a></code></li> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIInputStream" title="">nsIInputStream</a></code></li> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIOutputStream" title="">nsIOutputStream</a></code></li> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIFile" title="">nsIFile</a></code></li> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsICacheMetaDataVisitor" title="">nsICacheMetaDataVisitor</a></code></li> <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsICacheEntryInfo" title="">nsICacheEntryInfo</a></code></li>
</ul></div><div id="footer"><hr/><p>This page was originally written for <a href="https://developer.mozilla.org">developer.mozilla.org</a> and is used here under the <a href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike license</a> (CC-BY-SA).</p>
<p>Original contributors to this page: <a href="https://developer.mozilla.org/en-US/profiles/wbamberg">wbamberg</a>, <a href="https://developer.mozilla.org/en-US/profiles/Sheppy">Sheppy</a>, <a href="https://developer.mozilla.org/en-US/profiles/trevorh">trevorh</a>, <a href="https://developer.mozilla.org/en-US/profiles/Jimbeau">Jimbeau</a>, <a href="https://developer.mozilla.org/en-US/profiles/Arehman4">Arehman4</a>.</p></div></body>
</html>
