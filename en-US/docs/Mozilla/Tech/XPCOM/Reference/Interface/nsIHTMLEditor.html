<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/zilla-slab.css"/>
    <link rel="stylesheet" href="/css/page.css"/>
    <title>nsIHTMLEditor</title>
  </head>

  <body><nav class="breadcrumbs"><a href="../../../../../Mozilla.html">Mozilla</a>&raquo;<a href="../../../../Tech.html">Tech</a>&raquo;<a href="../../../XPCOM.html">XPCOM</a>&raquo;<a href="../../Reference.html">Reference</a>&raquo;<a href="../Interface.html">Interface</a></nav><div class="content-heading"><h1>nsIHTMLEditor</h1></div>
<div class="content"><p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/editor/idl/nsIHTMLEditor.idl" rel="custom">editor/idl/nsIHTMLEditor.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

<i>Please add a summary to this article.</i>
</span>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 5.0 (Firefox 5.0 / Thunderbird 5.0 / SeaMonkey 2.2)</span></div>
</div><p></p>

<h2 id="Method_overview" name="Method_overview">Method overview</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td><code>void <a href="#addDefaultProperty()">addDefaultProperty</a>(in nsIAtom aProperty, in AString aAttribute, in AString aValue);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#addInsertionListener()">addInsertionListener</a>(in nsIContentFilter inFilter);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#align()">align</a>(in AString aAlign);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#breakIsVisible()">breakIsVisible</a>(in nsIDOMNode aNode);</code> </td>
  </tr>
  <tr>
   <td><code>boolean <a href="#canDrag()">canDrag</a>(in nsIDOMEvent aEvent);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#checkSelectionStateForAnonymousButtons()">checkSelectionStateForAnonymousButtons</a>(in nsISelection aSelection);</code></td>
  </tr>
  <tr>
   <td><code>nsIDOMElement <a href="#createAnonymousElement()">createAnonymousElement</a>(in AString aTag, in nsIDOMNode aParentNode, in AString aAnonClass, in boolean aIsCreatedHidden);</code></td>
  </tr>
  <tr>
   <td><code>nsIDOMElement <a href="#createElementWithDefaults()">createElementWithDefaults</a>(in AString aTagName);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#decreaseFontSize()">decreaseFontSize</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#doDrag()">doDrag</a>(in nsIDOMEvent aEvent);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#getAlignment()">getAlignment</a>(out boolean aMixed, out short aAlign);</code></td>
  </tr>
  <tr>
   <td><code>AString <a href="#getBackgroundColorState()">getBackgroundColorState</a>(out boolean aMixed);</code></td>
  </tr>
  <tr>
   <td><code>nsIDOMElement <a href="#getElementOrParentByTagName()">getElementOrParentByTagName</a>(in AString aTagName, in nsIDOMNode aNode);</code></td>
  </tr>
  <tr>
   <td><code>AString <a href="#getFontColorState()">getFontColorState</a>(out boolean aMixed);</code></td>
  </tr>
  <tr>
   <td><code>AString <a href="#getFontFaceState()">getFontFaceState</a>(out boolean aMixed);</code></td>
  </tr>
  <tr>
   <td><code>AString <a href="#getHeadContentsAsHTML()">getHeadContentsAsHTML</a>();</code></td>
  </tr>
  <tr>
   <td><code>AString <a href="#getHighlightColorState()">getHighlightColorState</a>(out boolean aMixed);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#getIndentState()">getIndentState</a>(out boolean aCanIndent, out boolean aCanOutdent);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#getInlineProperty()">getInlineProperty</a>(in nsIAtom aProperty, in AString aAttribute, in AString aValue, out boolean aFirst, out boolean aAny, out boolean aAll);</code></td>
  </tr>
  <tr>
   <td><code>AString <a href="#getInlinePropertyWithAttrValue()">getInlinePropertyWithAttrValue</a>(in nsIAtom aProperty, in AString aAttribute, in AString aValue, out boolean aFirst, out boolean aAny, out boolean aAll);</code></td>
  </tr>
  <tr>
   <td><code>nsISupportsArray <a href="#getLinkedObjects()">getLinkedObjects</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#getListItemState()">getListItemState</a>(out boolean aMixed, out boolean aLI, out boolean aDT, out boolean aDD);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#getListState()">getListState</a>(out boolean aMixed, out boolean aOL, out boolean aUL, out boolean aDL);</code></td>
  </tr>
  <tr>
   <td><code>AString <a href="#getParagraphState()">getParagraphState</a>(out boolean aMixed);</code></td>
  </tr>
  <tr>
   <td><code>nsIDOMElement <a href="#getSelectedElement()">getSelectedElement</a>(in AString aTagName);</code></td>
  </tr>
  <tr>
   <td><code>nsIDOMElement <a href="#getSelectionContainer()">getSelectionContainer</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#ignoreSpuriousDragEvent()">ignoreSpuriousDragEvent</a>(in boolean aIgnoreSpuriousDragEvent);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#increaseFontSize()">increaseFontSize</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#indent()">indent</a>(in AString aIndent);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#insertElementAtSelection()">insertElementAtSelection</a>(in nsIDOMElement aElement, in boolean aDeleteSelection);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#insertFromDrop()">insertFromDrop</a>(in nsIDOMEvent aEvent);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#insertHTML()">insertHTML</a>(in AString aInputString);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#insertHTMLWithContext()">insertHTMLWithContext</a>(in AString aInputString, in AString aContextStr, in AString aInfoStr, in AString aFlavor, in nsIDOMDocument aSourceDoc, in nsIDOMNode aDestinationNode, in long aDestinationOffset, in boolean aDeleteSelection);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#insertLinkAroundSelection()">insertLinkAroundSelection</a>(in nsIDOMElement aAnchorElement);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#isAnonymousElement()">isAnonymousElement</a>(in nsIDOMElement aElement);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#makeOrChangeList()">makeOrChangeList</a>(in AString aListType, in boolean entireList, in AString aBulletType);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#nodeIsBlock()">nodeIsBlock</a>(in nsIDOMNode node);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#pasteNoFormatting()">pasteNoFormatting</a>(in long aSelectionType);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#rebuildDocumentFromSource()">rebuildDocumentFromSource</a>(in AString aSourceString);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#removeAllDefaultProperties()">removeAllDefaultProperties</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#removeAllInlineProperties()">removeAllInlineProperties</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#removeDefaultProperty()">removeDefaultProperty</a>(in nsIAtom aProperty, in AString aAttribute, in AString aValue);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#removeInlineProperty()">removeInlineProperty</a>(in nsIAtom aProperty, in AString aAttribute);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#removeInsertionListener()">removeInsertionListener</a>(in nsIContentFilter inFilter);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#removeList()">removeList</a>(in AString aListType);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#replaceHeadContentsWithHTML()">replaceHeadContentsWithHTML</a>(in AString aSourceToInsert);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#selectElement()">selectElement</a>(in nsIDOMElement aElement);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#setBackgroundColor()">setBackgroundColor</a>(in AString aColor);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#setBodyAttribute()">setBodyAttribute</a>(in AString aAttr, in AString aValue);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#setCaretAfterElement()">setCaretAfterElement</a>(in nsIDOMElement aElement);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#setCSSInlineProperty()">setCSSInlineProperty</a>(in nsIAtom aProperty, in AString aAttribute, in AString aValue);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#setDocumentTitle()">setDocumentTitle</a>(in AString aTitle);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#setInlineProperty()">setInlineProperty</a>(in nsIAtom aProperty, in AString aAttribute, in AString aValue);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#setParagraphFormat()">setParagraphFormat</a>(in AString aParagraphFormat);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#updateBaseURL()">updateBaseURL</a>();</code></td>
  </tr>
 </tbody>
</table>

<h2 id="Attributes" name="Attributes">Attributes</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Attribute</td>
   <td class="header">Type</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>isCSSEnabled</code></td>
   <td><code><a href="/en/boolean" title="en/boolean">boolean</a></code></td>
   <td>A boolean which is <code>true</code> is the HTMLEditor has been instantiated with CSS knowledge and if the CSS pref is currently checked.</td>
  </tr>
  <tr>
   <td><code>returnInParagraphCreatesNewParagraph</code></td>
   <td><code><a href="/en/boolean" title="en/boolean">boolean</a></code></td>
   <td>A boolean indicating if a return key pressed in a paragraph creates another paragraph or just inserts a &lt;br&gt; at the caret. </td>
  </tr>
 </tbody>
</table>

<h2 id="Constants" name="Constants">Constants</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Constant</td>
   <td class="header">Value</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>eLeft</code></td>
   <td><code>0</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>eCenter</code></td>
   <td><code>1</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>eRight</code></td>
   <td><code>2</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>eJustify</code></td>
   <td><code>3</code></td>
   <td> </td>
  </tr>
 </tbody>
</table>

<h2 id="Methods" name="Methods">Methods</h2>

<h3 id="addDefaultProperty()" name="addDefaultProperty()">addDefaultProperty()</h3>

<p><code>R</code>egisters a default style property with the editor.</p>

<pre class="eval">void addDefaultProperty(
  in nsIAtom aProperty,
  in AString aAttribute,
  in AString aValue
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aProperty</code></dt>
 <dd>The property to set by default.</dd>
 <dt><code>aAttribute</code></dt>
 <dd>The attribute of the property, if applicable. May be <code>null</code>. Example: <code>aProperty</code>="font", <code>aAttribute</code>="color"</dd>
 <dt><code>aValue</code></dt>
 <dd>If <code>aAttribute</code> is not <code>null</code>, the value of the attribute. Example: <code>aProperty</code>="font", <code>aAttribute</code>="color", <code>aValue</code>="0x00FFFF"</dd>
</dl>

<h3 id="addInsertionListener()" name="addInsertionListener()">addInsertionListener()</h3>

<p>Add listener for insertion override.</p>

<pre class="eval">void addInsertionListener(
  in nsIContentFilter inFilter
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>inFilter</code></dt>
 <dd>Function which callers want called during insertion.</dd>
</dl>

<h3 id="align()" name="align()">align()</h3>

<p>Document me!</p>

<pre class="eval">void align(
  in AString aAlign
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aAlign</code></dt>
 <dd> </dd>
</dl>

<p></p><h3 id="breakIsVisible()">breakIsVisible()</h3><p></p>

<p>Checks whether a BR node is visible to the user.</p>

<pre class="eval">boolean breakIsVisible(
  in nsIDOMNode aNode
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aNode</code></dt>
 <dd> </dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p> </p>

<h3 id="canDrag()" name="canDrag()">canDrag()</h3>

<p>Decides if a drag should be started (for example, based on the current selection and mousepoint).</p>

<pre class="eval">boolean canDrag(
  in nsIDOMEvent aEvent
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aEvent</code></dt>
 <dd> </dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p> </p>

<h3 id="checkSelectionStateForAnonymousButtons()" name="checkSelectionStateForAnonymousButtons()">checkSelectionStateForAnonymousButtons()</h3>

<p>Checks if the anonymous nodes created by the HTML editor have to be refreshed or hidden depending on a possible new state of the selection.</p>

<pre class="eval">void checkSelectionStateForAnonymousButtons(
  in nsISelection aSelection
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aSelection</code></dt>
 <dd>A selection.</dd>
</dl>

<h3 id="createAnonymousElement()" name="createAnonymousElement()">createAnonymousElement()</h3>

<p>Returns an anonymous nsDOMElement of type <code>aTag</code>, child of <code>aParentNode</code>. If aIsCreatedHidden is <code>true</code>, the class "hidden" is added to the created element. If <code>aAnonClass</code> is not the empty string, it becomes the value of the attribute "_moz_anonclass"</p>

<pre class="eval">nsIDOMElement createAnonymousElement(
  in AString aTag,
  in nsIDOMNode aParentNode,
  in AString aAnonClass,
  in boolean aIsCreatedHidden
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aTag</code></dt>
 <dd>A string representing the desired type of the element to create.</dd>
 <dt><code>aParentNode</code></dt>
 <dd>The parent node of the created anonymous element.</dd>
 <dt><code>aAnonClass</code></dt>
 <dd>Contents of the _moz_anonclass attribute.</dd>
 <dt><code>aIsCreatedHidden</code></dt>
 <dd>A boolean specifying if the class "hidden" is to be added to the created anonymous element.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>A DOM Element.</p>

<h3 id="createElementWithDefaults()" name="createElementWithDefaults()">createElementWithDefaults()</h3>

<p>Return a new element with default attribute values.</p>

<p>This does not rely on the selection, and is not sensitive to context.</p>

<p>Used primarily to supply new element for various insert element dialogs (Image, Link, Table, and HorizontalRule are the only returned elements as of 9/12/18); NamedAnchor was removed in Firefox 63.</p>

<pre class="eval">nsIDOMElement createElementWithDefaults(
  in AString aTagName
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aTagName</code></dt>
 <dd>The HTML tagname. Special input value for Links: Use "href" to get a link node (an "A" tag with the "href" attribute set)</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>The new element created.</p>

<h3 id="decreaseFontSize()" name="decreaseFontSize()">decreaseFontSize()</h3>

<p>Decrease font size for text in selection by 1 HTML unit All existing text is scanned for existing &lt;FONT SIZE&gt; attributes so they will be decreased instead of inserting new &lt;FONT&gt; tag.</p>

<pre class="eval">void decreaseFontSize();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h3 id="doDrag()" name="doDrag()">doDrag()</h3>

<p>Transfers the relevant data (as appropriate) to a transferable so it can later be dropped.</p>

<pre class="eval">void doDrag(
  in nsIDOMEvent aEvent
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aEvent</code></dt>
 <dd> </dd>
</dl>

<h3 id="getAlignment()" name="getAlignment()">getAlignment()</h3>

<p>Returns what alignment is in the selection.</p>

<pre class="eval">void getAlignment(
  out boolean aMixed,
  out short aAlign
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aMixed</code></dt>
 <dd><code>true</code> if there is more than one type of list item, or if there is some list and non-list.</dd>
 <dt><code>aAlign</code></dt>
 <dd>Enum value for first encountered alignment (left/center/right)</dd>
</dl>

<h3 id="getBackgroundColorState()" name="getBackgroundColorState()">getBackgroundColorState()</h3>

<p><code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIHTMLEditor#getFontColorState()">getFontColorState()</a></code> returns what font face is in the selection.</p>

<pre class="eval">AString getBackgroundColorState(
  out boolean aMixed
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aMixed</code></dt>
 <dd><code>true</code> if there is more than one font color.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>Color string. "" is returned for none.</p>

<h3 id="getElementOrParentByTagName()" name="getElementOrParentByTagName()">getElementOrParentByTagName()</h3>

<p>Return the input node or a parent matching the given <code>aTagName</code>, starting the search at the supplied node. An example of use is for testing if a node is in a table cell given a selection anchor node.</p>

<pre class="eval">nsIDOMElement getElementOrParentByTagName(
  in AString aTagName,
  in nsIDOMNode aNode
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aTagName</code></dt>
 <dd>The HTML tagname Special input values: Use "href" to get a link node (an "A" tag with the "href" attribute set) Use "list" to get an OL, UL, or DL list node Use "td" to get either a TD or TH cell node.</dd>
 <dt><code>aNode</code></dt>
 <dd>The node in the document to start the search. If it is <code>null</code>, the anchor node of the current selection is used.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>NS_EDITOR_ELEMENT_NOT_FOUND if an element is not found (passes NS_SUCCEEDED macro)</p>

<h3 id="getFontColorState()" name="getFontColorState()">getFontColorState()</h3>

<p>Returns what font face is in the selection.</p>

<pre class="eval">AString getFontColorState(
  out boolean aMixed
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aMixed</code></dt>
 <dd><code>true</code> if there is more than one font color.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>Color string. "" is returned for none.</p>

<h3 id="getFontFaceState()" name="getFontFaceState()">getFontFaceState()</h3>

<p>Returns what font face is in the selection.</p>

<pre class="eval">AString getFontFaceState(
  out boolean aMixed
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aMixed</code></dt>
 <dd><code>true</code> if there is more than one font face.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>Name of face. Note: "tt" is returned for tt tag. "" is returned for none.</p>

<h3 id="getHeadContentsAsHTML()" name="getHeadContentsAsHTML()">getHeadContentsAsHTML()</h3>

<p>Output the contents of the &lt;HEAD&gt; section as text/HTML format.</p>

<pre class="eval">AString getHeadContentsAsHTML();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p> </p>

<h3 id="getHighlightColorState()" name="getHighlightColorState()">getHighlightColorState()</h3>

<p>Returns what the highlight color of the selection.</p>

<pre class="eval">AString getHighlightColorState(
  out boolean aMixed
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aMixed</code></dt>
 <dd><code>true</code> if there is more than one font color.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>Color string. "" is returned for none.</p>

<h3 id="getIndentState()" name="getIndentState()">getIndentState()</h3>

<p>Document me!</p>

<pre class="eval">void getIndentState(
  out boolean aCanIndent,
  out boolean aCanOutdent
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aCanIndent</code></dt>
 <dd> </dd>
 <dt><code>aCanOutdent</code></dt>
 <dd> </dd>
</dl>

<h3 id="getInlineProperty()" name="getInlineProperty()">getInlineProperty()</h3>

<p>Gets aggregate properties of the current selection. All object in the current selection are scanned and their attributes are represented in a list of Property object.</p>

<pre class="eval">void getInlineProperty(
  in nsIAtom aProperty,
  in AString aAttribute,
  in AString aValue,
  out boolean aFirst,
  out boolean aAny,
  out boolean aAll
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aProperty</code></dt>
 <dd>The property to get on the selection.</dd>
 <dt><code>aAttribute</code></dt>
 <dd>The attribute of the property, if applicable. May be <code>null</code>. Example: <code>aProperty</code>="font", <code>aAttribute</code>="color"</dd>
 <dt><code>aValue</code></dt>
 <dd>If aAttribute is not <code>null</code>, the value of the attribute. May be <code>null</code>. Example: <code>aProperty</code>="font", <code>aAttribute</code>="color", <code>aValue</code>="0x00FFFF"</dd>
 <dt><code>aFirst</code></dt>
 <dd>PR_TRUE if the first text node in the selection has the property.</dd>
 <dt><code>aAny</code></dt>
 <dd>PR_TRUE if any of the text nodes in the selection have the property.</dd>
 <dt><code>aAll</code></dt>
 <dd>PR_TRUE if all of the text nodes in the selection have the property.</dd>
</dl>

<h3 id="getInlinePropertyWithAttrValue()" name="getInlinePropertyWithAttrValue()">getInlinePropertyWithAttrValue()</h3>

<pre class="eval">AString getInlinePropertyWithAttrValue(
  in nsIAtom aProperty,
  in AString aAttribute,
  in AString aValue,
  out boolean aFirst,
  out boolean aAny,
  out boolean aAll
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aProperty</code></dt>
 <dd> </dd>
 <dt><code>aAttribute</code></dt>
 <dd> </dd>
 <dt><code>aValue</code></dt>
 <dd> </dd>
 <dt><code>aFirst</code></dt>
 <dd> </dd>
 <dt><code>aAny</code></dt>
 <dd> </dd>
 <dt><code>aAll</code></dt>
 <dd> </dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p> </p>

<h3 id="getLinkedObjects()" name="getLinkedObjects()">getLinkedObjects()</h3>

<p>Find all the nodes in the document which contain references to outside URIs (for example a href, img src, script src, and so on.) The objects in the array will be type <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURIRefObject" title="">nsIURIRefObject</a></code>.</p>

<pre class="eval">nsISupportsArray getLinkedObjects();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>ANodeList the linked nodes found.</p>

<h3 id="getListItemState()" name="getListItemState()">getListItemState()</h3>

<p><code>getListItemState</code> returns what list item type is in the selection.</p>

<pre class="eval">void getListItemState(
  out boolean aMixed,
  out boolean aLI,
  out boolean aDT,
  out boolean aDD
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aMixed</code></dt>
 <dd><code>true</code> if there is more than one type of list item, or if there is some list and non-list.</dd>
 <dt><code>aLI</code></dt>
 <dd><code>true</code> if "li" list items are selected.</dd>
 <dt><code>aDT</code></dt>
 <dd><code>true</code> if "dt" list items are selected.</dd>
 <dt><code>aDD</code></dt>
 <dd><code>true</code> if "dd" list items are selected.</dd>
</dl>

<h3 id="getListState()" name="getListState()">getListState()</h3>

<p>Returns what list type is in the selection.</p>

<pre class="eval">void getListState(
  out boolean aMixed,
  out boolean aOL,
  out boolean aUL,
  out boolean aDL
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aMixed</code></dt>
 <dd><code>true</code> if there is more than one type of list, or if there is some list and non-list.</dd>
 <dt><code>aOL</code></dt>
 <dd>The company that employs me. No, really, it is <code>true</code> if an "ol" list is selected.</dd>
 <dt><code>aUL</code></dt>
 <dd><code>true</code> if an "ul" list is selected.</dd>
 <dt><code>aDL</code></dt>
 <dd><code>true</code> if a "dl" list is selected.</dd>
</dl>

<h3 id="getParagraphState()" name="getParagraphState()">getParagraphState()</h3>

<p>Returns what block tag paragraph format is in the selection.</p>

<pre class="eval">AString getParagraphState(
  out boolean aMixed
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aMixed</code></dt>
 <dd><code>true</code> if there is more than one format.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>Name of block tag. "" is returned for none.</p>

<h3 id="getSelectedElement()" name="getSelectedElement()">getSelectedElement()</h3>

<p>Return an element only if it is the only node selected, such as an image, horizontal rule, and so on. The exception is a link, which is more like a text attribute: The Anchor tag is returned if the selection is within the textnode(s) that are children of the "A" node. This could be a collapsed selection, that is, a caret within the link text.</p>

<pre class="eval">nsIDOMElement getSelectedElement(
  in AString aTagName
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aTagName</code></dt>
 <dd>The HTML tagname or and empty string to get any element (but only if it is the only element selected). Special input values for Links: Use "href" to get a link node (an "A" tag with the "href" attribute set).</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>NS_EDITOR_ELEMENT_NOT_FOUND if an element is not found (passes NS_SUCCEEDED macro)</p>

<h3 id="getSelectionContainer()" name="getSelectionContainer()">getSelectionContainer()</h3>

<p>Returns the deepest container of the selection.</p>

<pre class="eval">nsIDOMElement getSelectionContainer();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>A DOM Element.</p>

<h3 id="ignoreSpuriousDragEvent()" name="ignoreSpuriousDragEvent()">ignoreSpuriousDragEvent()</h3>

<p>Used to suppress spurious drag/drop events to workaround <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=50703" title="After double-click that launches dialog, mouse up on dialog button triggers dragNdrop in content window">bug 50703</a>. Do not use this method! It will go away after first release!</p>

<pre class="eval">void ignoreSpuriousDragEvent(
  in boolean aIgnoreSpuriousDragEvent
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aIgnoreSpuriousDragEvent</code></dt>
 <dd> </dd>
</dl>

<h3 id="increaseFontSize()" name="increaseFontSize()">increaseFontSize()</h3>

<p>Increase font size for text in selection by 1 HTML unit All existing text is scanned for existing &lt;FONT SIZE&gt; attributes so they will be incremented instead of inserting new &lt;FONT&gt; tag.</p>

<pre class="eval">void increaseFontSize();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h3 id="indent()" name="indent()">indent()</h3>

<p>Document me!</p>

<pre class="eval">void indent(
  in AString aIndent
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aIndent</code></dt>
 <dd> </dd>
</dl>

<h3 id="insertElementAtSelection()" name="insertElementAtSelection()">insertElementAtSelection()</h3>

<p>Insert an element, which may have child nodes, at the selection Used primarily to insert a new element for various insert element dialogs, but it enforces the HTML 4.0 DTD "CanContain" rules, so it should be useful for other elements.</p>

<pre class="eval">void insertElementAtSelection(
  in nsIDOMElement aElement,
  in boolean aDeleteSelection
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aElement</code></dt>
 <dd>The element to insert.</dd>
 <dt><code>aDeleteSelection</code></dt>
 <dd>Delete the selection before inserting If aDeleteSelection is PR_FALSE, then the element is inserted after the end of the selection for all element except Named Anchors, which insert before the selection.</dd>
</dl>

<h3 id="insertFromDrop()" name="insertFromDrop()">insertFromDrop()</h3>

<p>Looks for a dragsession and inserts the relevant data in response to a drop.</p>

<pre class="eval">void insertFromDrop(
  in nsIDOMEvent aEvent
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aEvent</code></dt>
 <dd> </dd>
</dl>

<h3 id="insertHTML()" name="insertHTML()">insertHTML()</h3>

<p>Insert some HTML source at the current location.</p>

<pre class="eval">void insertHTML(
  in AString aInputString
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aInputString</code></dt>
 <dd>The string to be inserted.</dd>
</dl>

<h3 id="insertHTMLWithContext()" name="insertHTMLWithContext()">insertHTMLWithContext()</h3>

<p>Insert some HTML source, interpreting the string argument according to the given context.</p>

<pre class="eval">void insertHTMLWithContext(
  in AString aInputString,
  in AString aContextStr,
  in AString aInfoStr,
  in AString aFlavor,
  in nsIDOMDocument aSourceDoc,
  in nsIDOMNode aDestinationNode,
  in long aDestinationOffset,
  in boolean aDeleteSelection
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aInputString</code></dt>
 <dd>The string to be inserted.</dd>
 <dt><code>aContextStr</code></dt>
 <dd>Context of insertion.</dd>
 <dt><code>aInfoStr</code></dt>
 <dd>Related info to aInputString.</dd>
 <dt><code>aFlavor</code></dt>
 <dd>Transferable flavor, can be ""</dd>
 <dt><code>aSourceDoc</code></dt>
 <dd>Document where input was dragged from (may be <code>null</code>)</dd>
 <dt><code>aDestinationNode</code></dt>
 <dd>Location for insertion (such as when dropped)</dd>
 <dt><code>aDestinationOffset</code></dt>
 <dd>Used with aDestNode to determine insert location.</dd>
 <dt><code>aDeleteSelection</code></dt>
 <dd>Used with aDestNode during drag&amp;drop.</dd>
</dl>

<h3 id="insertLinkAroundSelection()" name="insertLinkAroundSelection()">insertLinkAroundSelection()</h3>

<p>Insert an link element as the parent of the current selection.</p>

<pre class="eval">void insertLinkAroundSelection(
  in nsIDOMElement aAnchorElement
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aAnchorElement</code></dt>
 <dd> </dd>
</dl>

<h3 id="isAnonymousElement()" name="isAnonymousElement()">isAnonymousElement()</h3>

<pre class="eval">boolean isAnonymousElement(
  in nsIDOMElement aElement
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aElement</code></dt>
 <dd> </dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p> </p>

<h3 id="makeOrChangeList()" name="makeOrChangeList()">makeOrChangeList()</h3>

<pre class="eval">void makeOrChangeList(
  in AString aListType,
  in boolean entireList,
  in AString aBulletType
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aListType</code></dt>
 <dd> </dd>
 <dt><code>entireList</code></dt>
 <dd> </dd>
 <dt><code>aBulletType</code></dt>
 <dd> </dd>
</dl>

<h3 id="nodeIsBlock()" name="nodeIsBlock()">nodeIsBlock()</h3>

<p>Tests if a node is a BLOCK element according the the HTML 4.0 DTD. This does NOT consider CSS effect on display type.</p>

<pre class="eval">boolean nodeIsBlock(
  in nsIDOMNode node
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>node</code></dt>
 <dd> </dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p> </p>

<h3 id="pasteNoFormatting()" name="pasteNoFormatting()">pasteNoFormatting()</h3>

<p>Paste the text in the OS clipboard at the cursor position, replacing the selected text (if any), but strip out any HTML styles and formatting.</p>

<pre class="eval">void pasteNoFormatting(
  in long aSelectionType
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aSelectionType</code></dt>
 <dd> </dd>
</dl>

<h3 id="rebuildDocumentFromSource()" name="rebuildDocumentFromSource()">rebuildDocumentFromSource()</h3>

<p>Rebuild the entire document from source HTML Needed to be able to edit HEAD and other outside-of-BODY content.</p>

<pre class="eval">void rebuildDocumentFromSource(
  in AString aSourceString
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aSourceString</code></dt>
 <dd>HTML source string of the entire new document.</dd>
</dl>

<h3 id="removeAllDefaultProperties()" name="removeAllDefaultProperties()">removeAllDefaultProperties()</h3>

<p>Unregisters all default style properties with the editor.</p>

<pre class="eval">void removeAllDefaultProperties();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h3 id="removeAllInlineProperties()" name="removeAllInlineProperties()">removeAllInlineProperties()</h3>

<p>Deletes all the inline properties from all text in the current selection.</p>

<pre class="eval">void removeAllInlineProperties();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h3 id="removeDefaultProperty()" name="removeDefaultProperty()">removeDefaultProperty()</h3>

<p>Unregisters a default style property with the editor.</p>

<pre class="eval">void removeDefaultProperty(
  in nsIAtom aProperty,
  in AString aAttribute,
  in AString aValue
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aProperty</code></dt>
 <dd>The property to remove from defaults.</dd>
 <dt><code>aAttribute</code></dt>
 <dd>The attribute of the property, if applicable. May be <code>null</code>. Example: <code>aProperty</code>="font", <code>aAttribute</code>="color"</dd>
 <dt><code>aValue</code></dt>
 <dd>If <code>aAttribute</code> is not <code>null</code>, the value of the attribute. Example: <code>aProperty</code>="font", <code>aAttribute</code>="color", <code>aValue</code>="0x00FFFF"</dd>
</dl>

<h3 id="removeInlineProperty()" name="removeInlineProperty()">removeInlineProperty()</h3>

<p>Deletes the properties from all text in the current selection. If <code>aProperty</code> is not set on the selection, nothing is done.</p>

<pre class="eval">void removeInlineProperty(
  in nsIAtom aProperty,
  in AString aAttribute
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aProperty</code></dt>
 <dd>The property to remove from the selection All atoms are for normal HTML tags (for example <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIEditorProperty#font()">nsIEditorProperty.font()</a></code>) except when you want to remove just links and not named anchors. For that, use <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIEditorProperty#href()">nsIEditorProperty.href()</a></code>.</dd>
 <dt><code>aAttribute</code></dt>
 <dd>The attribute of the property, if applicable. May be <code>null</code>. Example: <code>aProperty</code>=<code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIEditorProptery#font()">nsIEditorProptery.font()</a></code>, <code>aAttribute</code>="color" <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIEditProperty#allAttributes()">nsIEditProperty.allAttributes()</a></code> is special. It indicates that all content-based text properties are to be removed from the selection.</dd>
</dl>

<h3 id="removeInsertionListener()" name="removeInsertionListener()">removeInsertionListener()</h3>

<p>Remove listener for insertion override.</p>

<pre class="eval">void removeInsertionListener(
  in nsIContentFilter inFilter
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>inFilter</code></dt>
 <dd>Function which callers do not want called during insertion.</dd>
</dl>

<h3 id="removeList()" name="removeList()">removeList()</h3>

<p>Document me!</p>

<pre class="eval">void removeList(
  in AString aListType
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aListType</code></dt>
 <dd> </dd>
</dl>

<h3 id="replaceHeadContentsWithHTML()" name="replaceHeadContentsWithHTML()">replaceHeadContentsWithHTML()</h3>

<p>Replace all children of &lt;HEAD&gt; with string of HTML source.</p>

<pre class="eval">void replaceHeadContentsWithHTML(
  in AString aSourceToInsert
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aSourceToInsert</code></dt>
 <dd> </dd>
</dl>

<h3 id="selectElement()" name="selectElement()">selectElement()</h3>

<p>Set the selection at the suppled element.</p>

<pre class="eval">void selectElement(
  in nsIDOMElement aElement
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aElement</code></dt>
 <dd>An element in the document.</dd>
</dl>

<h3 id="setBackgroundColor()" name="setBackgroundColor()">setBackgroundColor()</h3>

<p>Set the value of the "bgcolor" attribute on the document's &lt;body&gt; element.</p>

<pre class="eval">void setBackgroundColor(
  in AString aColor
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aColor</code></dt>
 <dd>The HTML color string, such as "#ffccff" or "yellow"</dd>
</dl>

<h3 id="setBodyAttribute()" name="setBodyAttribute()">setBodyAttribute()</h3>

<p>Set an attribute on the document's &lt;body&gt; element such as text, link, background colors.</p>

<pre class="eval">void setBodyAttribute(
  in AString aAttr,
  in AString aValue
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aAttr</code></dt>
 <dd>The attribute to be set.</dd>
 <dt><code>aValue</code></dt>
 <dd>The value of the attribute.</dd>
</dl>

<h3 id="setCaretAfterElement()" name="setCaretAfterElement()">setCaretAfterElement()</h3>

<p>Create a collapsed selection just after aElement.</p>

<p>The selection is set to parent-of-aElement with an offset 1 greater than aElement's offset but it enforces the HTML 4.0 DTD "CanContain" rules, so it should be useful for other elements.</p>

<pre class="eval">void setCaretAfterElement(
  in nsIDOMElement aElement
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aElement</code></dt>
 <dd>An element in the document.</dd>
</dl>

<h3 id="setCSSInlineProperty()" name="setCSSInlineProperty()">setCSSInlineProperty()</h3>

<p><code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIHTMLEditor#SetInlineProperty()">SetInlineProperty()</a></code> sets the aggregate properties on the current selection.</p>

<pre class="eval">void setCSSInlineProperty(
  in nsIAtom aProperty,
  in AString aAttribute,
  in AString aValue
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aProperty</code></dt>
 <dd>The property to set on the selection.</dd>
 <dt><code>aAttribute</code></dt>
 <dd>The attribute of the property, if applicable. May be <code>null</code>. Example: <code>aProperty</code>="font", <code>aAttribute</code>="color"</dd>
 <dt><code>aValue</code></dt>
 <dd>If <code>aAttribute</code> is not <code>null</code>, the value of the attribute. May be <code>null</code>. Example: <code>aProperty</code>="font", <code>aAttribute</code>="color", <code>aValue</code>="0x00FFFF"</dd>
</dl>

<h3 id="setDocumentTitle()" name="setDocumentTitle()">setDocumentTitle()</h3>

<p>Set the documents title.</p>

<pre class="eval">void setDocumentTitle(
  in AString aTitle
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aTitle</code></dt>
 <dd> </dd>
</dl>

<h3 id="setInlineProperty()" name="setInlineProperty()">setInlineProperty()</h3>

<pre class="eval">void setInlineProperty(
  in nsIAtom aProperty,
  in AString aAttribute,
  in AString aValue
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aProperty</code></dt>
 <dd> </dd>
 <dt><code>aAttribute</code></dt>
 <dd> </dd>
 <dt><code>aValue</code></dt>
 <dd> </dd>
</dl>

<h3 id="setParagraphFormat()" name="setParagraphFormat()">setParagraphFormat()</h3>

<p>Insert a block paragraph tag around selection.</p>

<pre class="eval">void setParagraphFormat(
  in AString aParagraphFormat
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aParagraphFormat</code></dt>
 <dd>"p", "h1" to "h6", "address", "pre", or "blockquote"</dd>
</dl>

<h3 id="updateBaseURL()" name="updateBaseURL()">updateBaseURL()</h3>

<p>Set the BaseURL for the document to the current URL but only if the page doesn't have a &lt;base&gt; tag This should be done after the document URL has changed, such as after saving a file This is used as base for relativizing link and image urls.</p>

<pre class="eval">void updateBaseURL();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p></div><div id="footer"><hr/><p>This page was originally written for <a href="https://developer.mozilla.org">developer.mozilla.org</a> and is used here under the <a href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike license</a> (CC-BY-SA).</p>
<p>Original contributors to this page: <a href="https://developer.mozilla.org/en-US/profiles/wbamberg">wbamberg</a>, <a href="https://developer.mozilla.org/en-US/profiles/mdnwebdocs-bot">mdnwebdocs-bot</a>, <a href="https://developer.mozilla.org/en-US/profiles/chrisdavidmills">chrisdavidmills</a>, <a href="https://developer.mozilla.org/en-US/profiles/Sheppy">Sheppy</a>, <a href="https://developer.mozilla.org/en-US/profiles/trevorh">trevorh</a>.</p></div></body>
</html>
