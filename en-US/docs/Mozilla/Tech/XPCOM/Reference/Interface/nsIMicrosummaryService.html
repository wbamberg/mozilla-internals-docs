<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/zilla-slab.css"/>
    <link rel="stylesheet" href="/css/page.css"/>
    <title>nsIMicrosummaryService</title>
  </head>

  <body><nav class="breadcrumbs"><a href="../../../../../Mozilla.html">Mozilla</a>&raquo;<a href="../../../../Tech.html">Tech</a>&raquo;<a href="../../../XPCOM.html">XPCOM</a>&raquo;<a href="../../Reference.html">Reference</a>&raquo;<a href="../Interface.html">Interface</a></nav><div class="content-heading"><h1>nsIMicrosummaryService</h1></div>
<div class="content"><p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/toolkit/components/places/public/nsIMicrosummaryService.idl" rel="custom">toolkit/components/places/public/nsIMicrosummaryService.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

This interface provides methods for managing installed microsummaries, and the bookmarks they apply to.
</span>

  <div style="height: 42px; position: relative; padding: 2px; width: auto;">

  <div style="top: 22px; font-size: 11px; position: absolute;">1.0</div>
  
  <div style="top: 22px; font-size: 11px; position: absolute; left: 0px; text-align: right; float: right; width: 100%;">66</div>
  
  <div style="height: 8px; top: 16px; background: #dd0000; left: 0px; position: absolute; width: 5.714285714285714%;"></div>
  
<div style="height: 8px; top: 16px; left: 5.714285714285714%; background: #00dd00; position: absolute; width: 8.57142857142857%;" title="Introduced in Gecko 1.8 (Firefox 1.5 / Thunderbird 1.5 / SeaMonkey 1.0)"></div>

<div style="top: 0px; font-size: 11px; position: absolute; left: 5.714285714285714%;">Introduced</div>
<div style="top: 22px; font-size: 11px; position: absolute; left: 5.714285714285714%;">Gecko 1.8</div>

    <div style="height: 8px; top: 16px; left: 14.285714285714285%; background: #000000; position: absolute; width: 85.71428571428572%;" title="Obsolete in Gecko 6.0 (Firefox 6.0 / Thunderbird 6.0 / SeaMonkey 2.3)"></div>
    
  <div style="top: 0px; font-size: 11px; position: absolute; left: 0px; text-align: right; float: right; width: 14.285714285714285%;">Obsolete</div>
  
  <div style="top: 22px; font-size: 11px; position: absolute; left: 0px; text-align: right; float: right; width: 14.285714285714285%;">Gecko 6.0</div>
  
    <div style="height: 8px; top: 16px; left: 8.071428571428571%; background: #eeee00; position: absolute; width: 1%; border-radius: 4px; -webkit-border-radius: 4px;" title="Last changed in Gecko 1.9 (Firefox 3)"></div>
    
</div>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 1.9 (Firefox 3)</span></div>
</div><p></p>
<div class="warning">
 <strong>Warning:</strong> Microsummary support was removed in Gecko 6.0 (Firefox 6.0 / Thunderbird 6.0 / SeaMonkey 2.3)</div>
<p>Implemented by: <code>@mozilla.org/microsummary/service;1</code> as a service:</p>
<pre class="eval">var microsummaryService = Components.classes["@mozilla.org/microsummary/service;1"]
                          .getService(Components.interfaces.nsIMicrosummaryService);
</pre>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table">
 <tbody>
  <tr>
   <td><code>void <a href="#addGenerator()">addGenerator</a>(in nsIURI generatorURI);</code></td>
  </tr>
  <tr>
   <td><code>nsIMicrosummary <a href="#createMicrosummary()">createMicrosummary</a>(in nsIURI pageURI, in nsIURI generatorURI);</code> </td>
  </tr>
  <tr>
   <td><code>nsISimpleEnumerator <a href="#getBookmarks()">getBookmarks</a>();</code></td>
  </tr>
  <tr>
   <td><code>nsIMicrosummaryGenerator <a href="#getGenerator()">getGenerator</a>(in nsIURI generatorURI);</code> </td>
  </tr>
  <tr>
   <td><code>nsIMicrosummarySet <a href="#getMicrosummaries()">getMicrosummaries</a>(in nsIURI pageURI, in long long bookmarkID);</code></td>
  </tr>
  <tr>
   <td><code>nsIMicrosummary <a href="#getMicrosummary()">getMicrosummary</a>(in long long bookmarkID);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#hasMicrosummary()">hasMicrosummary</a>(in long long bookmarkID);</code></td>
  </tr>
  <tr>
   <td><code>nsIMicrosummaryGenerator <a href="#installGenerator()">installGenerator</a>(in nsIDOMDocument xmlDefinition);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#isMicrosummary()">isMicrosummary</a>(in long long bookmarkID, in nsIMicrosummary microsummary);</code></td>
  </tr>
  <tr>
   <td><code>nsIMicrosummary <a href="#refreshMicrosummary()">refreshMicrosummary</a>(in long long bookmarkID);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#removeMicrosummary()">removeMicrosummary</a>(in long long bookmarkID);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#setMicrosummary()">setMicrosummary</a>(in long long bookmarkID, in nsIMicrosummary microsummary);</code></td>
  </tr>
 </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<h3 id="addGenerator()" name="addGenerator()">addGenerator()</h3>
<p>Install the microsummary generator from the resource at the supplied URI. Callable by content via <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsISidebar#addMicrosummaryGenerator()">nsISidebar.addMicrosummaryGenerator()</a></code>.</p>
<pre class="eval">void addGenerator(
  in nsIURI generatorURI
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>generatorURI</code></dt>
 <dd>
  The URI of the resource providing the generator.</dd>
</dl>
<p></p><h3 id="createMicrosummary()">createMicrosummary()</h3><p></p>
<p>Create a microsummary for a given page URI and generator URI.</p>
<pre class="eval">nsIMicrosummary createMicrosummary(
  in nsIURI pageURI,
  in nsIURI generatorURI
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>pageURI</code></dt>
 <dd>
  The URI of the page to be summarized.</dd>
 <dt>
  <code>generatorURI</code></dt>
 <dd>
  The URI of the microsummary generator.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Returns an <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMicrosummary" title="">nsIMicrosummary</a></code> for the given page and generator URIs.</p>
<h3 id="getBookmarks()" name="getBookmarks()">getBookmarks()</h3>
<p>Get the set of bookmarks with microsummaries. In the old RDF-based bookmarks datastore, bookmark IDs are <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIRDFResource" title="">nsIRDFResource</a></code> objects. In the new Places-based datastore, they are <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI" title="">nsIURI</a></code> objects.</p>
<pre class="eval">nsISimpleEnumerator getBookmarks();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Returns an <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISimpleEnumerator" title="">nsISimpleEnumerator</a></code> enumeration of bookmark IDs.</p>
<p></p><h3 id="getGenerator()">getGenerator()</h3><p></p>
<p>Return a microsummary generator for the given URI.</p>
<pre class="eval">nsIMicrosummaryGenerator getGenerator(
  in nsIURI generatorURI
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>generatorURI</code></dt>
 <dd>
  The URI of the generator.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Returns an <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMicrosummaryGenerator" title="">nsIMicrosummaryGenerator</a></code> for the given URI.</p>
<h3 id="getMicrosummaries()" name="getMicrosummaries()">getMicrosummaries()</h3>
<p>Get the set of microsummaries available for a given page. The set might change after this method returns, since this method will trigger an asynchronous load of the page in question (if it isn't already loaded) to see if it references any page-specific microsummaries.</p>
<p>If the caller passes a bookmark ID, and one of the microsummaries is the current one for the bookmark, this method will retrieve content from the datastore for that microsummary, which is useful when callers want to display a list of microsummaries for a page that isn't loaded, and they want to display the actual content of the selected microsummary immediately (rather than after the content is asynchronously loaded).</p>
<pre class="eval">nsIMicrosummarySet getMicrosummaries(
  in nsIURI pageURI,
  in long long bookmarkID <span class="inlineIndicator optional optionalInline">Optional</span>
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>pageURI</code></dt>
 <dd>
  The URI of the page for which to retrieve available microsummaries.</dd>
 <dt>
  <code>bookmarkID</code> <span class="inlineIndicator optional optionalInline">Optional</span></dt>
 <dd>
  The ID of the bookmark for which this method is being called.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Returns an <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMicrosummarySet" title="">nsIMicrosummarySet</a></code> of <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMicrosummaries" title="">nsIMicrosummaries</a></code> for the given page.</p>
<h3 id="getMicrosummary()" name="getMicrosummary()">getMicrosummary()</h3>
<p>Get the current microsummary for the given bookmark.</p>
<pre class="eval">nsIMicrosummary getMicrosummary(
  in long long bookmarkID
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>bookmarkID</code></dt>
 <dd>
  The bookmark for which to get the current microsummary.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Returns the current microsummary for the bookmark, or null if the bookmark does not have a current microsummary.</p>
<h3 id="hasMicrosummary()" name="hasMicrosummary()">hasMicrosummary()</h3>
<p>Whether or not the given bookmark has a current microsummary.</p>
<pre class="eval">boolean hasMicrosummary(
  in long long bookmarkID
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>bookmarkID</code></dt>
 <dd>
  The bookmark for which to set the current microsummary.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Returns a boolean representing whether or not the given bookmark has a current microsummary.</p>
<h3 id="installGenerator()" name="installGenerator()">installGenerator()</h3>
<p>Install the microsummary generator in the given XML definition.</p>
<pre class="eval">nsIMicrosummaryGenerator installGenerator(
  in nsIDOMDocument xmlDefinition
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>xmlDefinition</code></dt>
 <dd>
  An <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIDOMDocument" title="">nsIDOMDocument</a></code> XML document defining the generator.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Returns the <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMicrosummaryGenerator" title="">nsIMicrosummaryGenerator</a></code> that was installed.</p>
<h3 id="isMicrosummary()" name="isMicrosummary()">isMicrosummary()</h3>
<p>Reports whether or not the given microsummary is the current microsummary for the given bookmark.</p>
<pre class="eval">boolean isMicrosummary(
  in long long bookmarkID,
  in nsIMicrosummary microsummary
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>bookmarkID</code></dt>
 <dd>
  The bookmark to check.</dd>
 <dt>
  <code>microsummary</code></dt>
 <dd>
  The microsummary to check.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Returns whether or not the microsummary is the current one for the bookmark.</p>
<h3 id="refreshMicrosummary()" name="refreshMicrosummary()">refreshMicrosummary()</h3>
<p>Refreshes a microsummary, updating its value in the datastore and UI. If this method can refresh the microsummary instantly, it will. Otherwise, it'll asynchronously download the necessary information (the generator and/or page) before refreshing the microsummary.</p>
<p>Callers should check the <code>content</code> property of the returned microsummary object to distinguish between sync and async refreshes. If its value is <code>null</code>, then it's an async refresh, and the caller should register itself as an <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMicrosummaryObserver" title="">nsIMicrosummaryObserver</a></code> via <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIMicrosummary#addObserver()">nsIMicrosummary.addObserver()</a></code> to find out when the refresh completes.</p>
<pre class="eval">nsIMicrosummary refreshMicrosummary(
  in long long bookmarkID
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>bookmarkID</code></dt>
 <dd>
  The bookmark whose microsummary is being refreshed.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Returns the microsummary being refreshed.</p>
<h3 id="removeMicrosummary()" name="removeMicrosummary()">removeMicrosummary()</h3>
<p>Remove the current microsummary for the given bookmark.</p>
<pre class="eval">void removeMicrosummary(
  in long long bookmarkID
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>bookmarkID</code></dt>
 <dd>
  The bookmark for which to remove the current microsummary.</dd>
</dl>
<h3 id="setMicrosummary()" name="setMicrosummary()">setMicrosummary()</h3>
<p>Set the current microsummary for the given bookmark.</p>
<pre class="eval">void setMicrosummary(
  in long long bookmarkID,
  in nsIMicrosummary microsummary
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>bookmarkID</code></dt>
 <dd>
  The bookmark for which to set the current microsummary.</dd>
 <dt>
  <code>microsummary</code></dt>
 <dd>
  The microsummary to set as the current one.</dd>
</dl>
<h2 id="See_also" name="See_also">See also</h2>
<ul>
 <li><a href="/en/Microsummary_topics" title="en/Microsummary_topics">Microsummary topics</a></li>
 <li><a href="/en/Creating_a_Microsummary" title="en/Creating_a_Microsummary">Creating a Microsummary</a></li>
</ul></div><div id="footer"><hr/><p>This page was originally written for <a href="https://developer.mozilla.org">developer.mozilla.org</a> and is used here under the <a href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike license</a> (CC-BY-SA).</p>
<p>Original contributors to this page: <a href="https://developer.mozilla.org/en-US/profiles/wbamberg">wbamberg</a>, <a href="https://developer.mozilla.org/en-US/profiles/mdnwebdocs-bot">mdnwebdocs-bot</a>, <a href="https://developer.mozilla.org/en-US/profiles/Sheppy">Sheppy</a>, <a href="https://developer.mozilla.org/en-US/profiles/Nickolay">Nickolay</a>, <a href="https://developer.mozilla.org/en-US/profiles/trevorh">trevorh</a>, <a href="https://developer.mozilla.org/en-US/profiles/Wjjohnst">Wjjohnst</a>.</p></div></body>
</html>
