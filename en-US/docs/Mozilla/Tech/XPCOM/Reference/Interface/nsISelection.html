<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/zilla-slab.css"/>
    <link rel="stylesheet" href="/css/page.css"/>
    <title>nsISelection</title>
  </head>

  <body><nav class="breadcrumbs"><a href="../../../../../Mozilla.html">Mozilla</a>&raquo;<a href="../../../../Tech.html">Tech</a>&raquo;<a href="../../../XPCOM.html">XPCOM</a>&raquo;<a href="../../Reference.html">Reference</a>&raquo;<a href="../Interface.html">Interface</a></nav><div class="content-heading"><h1>nsISelection</h1></div>
<div class="content"><h2 id="nsISelection">nsISelection</h2>
<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/content/base/public/nsISelection.idl" rel="custom">content/base/public/nsISelection.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

??? Add brief description of Interface ???
</span>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 13.0 (Firefox 13.0 / Thunderbird 13.0 / SeaMonkey 2.10)</span></div>
</div><p></p>
<p>Interface for manipulating and querying the current selected range of nodes within the document.</p>
<p>Implemented by: <code>?????????????????????????????????????</code>. To create an instance, use:</p>
<p>Implemented by: <code>?????????????????????????????????????</code> as a service:</p>
<pre class="eval">var selection = Components.classes["@mozilla.org/????????????????????????????"]
                .createInstance(Components.interfaces.nsISelection);
</pre>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table">
 <tbody>
  <tr>
   <td><code>void <a href="#addRange()">addRange</a>(in <code><a href="/en-US/docs/Web/API/range">nsIDOMRange</a></code> range);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#collapse()">collapse</a>(in <a href="/en-US/docs/XPCOM_Interface_Reference/nsIDOMNode">nsIDOMNode</a> parentNode, in long offset);</code></td>
  </tr>
  <tr>
   <td><code>[noscript,notxpcom,nostdcall] boolean <a href="#collapsed()">collapsed</a>();</code> </td>
  </tr>
  <tr>
   <td><code>void <a href="#collapseNative()">collapseNative</a>(in <code><a href="/en-US/docs/">nsIDOMNode</a></code> parentNode, in long offset);</code> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span> </td>
  </tr>
  <tr>
   <td><code>void <a href="#collapseToEnd()">collapseToEnd</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#collapseToStart()">collapseToStart</a>();</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#containsNode()">containsNode</a>(in <a href="/en-US/docs/XPCOM_Interface_Reference/nsIDOMNode">nsIDOMNode</a> node, in boolean partlyContained);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#deleteFromDocument()">deleteFromDocument</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#extend()">extend</a>(in <a href="/en-US/docs/">nsIDOMNode</a> parentNode, in long offset);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#extendNative()">extendNative</a>(in <code><a href="/en-US/docs/">nsIDOMNode</a></code> parentNode, in long offset);</code> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span> </td>
  </tr>
  <tr>
   <td><code>nsIDOMRange <a href="#getRangeAt()">getRangeAt</a>(in long index);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#modify()">modify</a>(in <a href="/en-US/docs/Web/API/DOMString">DOMString</a> alter, in <a href="/en-US/docs/">DOMString</a> direction, in <a href="/en-US/docs/">DOMString</a> granularity);</code> </td>
  </tr>
  <tr>
   <td><code>void <a href="#removeAllRanges()">removeAllRanges</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#removeRange()">removeRange</a>(in <a href="/en-US/docs/Web/API/range">nsIDOMRange</a> range);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#selectAllChildren()">selectAllChildren</a>(in <code><code><a href="/en-US/docs/">nsIDOMNode</a></code></code> parentNode);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#selectionLanguageChange()">selectionLanguageChange</a>(in boolean langRTL);</code></td>
  </tr>
  <tr>
   <td><code>DOMString <a href="#toString()">toString</a>();</code></td>
  </tr>
 </tbody>
</table>
<h2 id="Attributes" name="Attributes">Attributes</h2>
<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Attribute</td>
   <td class="header">Type</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>anchorNode</code></td>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIDOMNode" title="">nsIDOMNode</a></code></code></td>
   <td>Returns the node in which the selection begins. <strong>Read only.</strong></td>
  </tr>
  <tr>
   <td><code>anchorOffset</code></td>
   <td><code><a title="en/long">long</a></code></td>
   <td>The offset within the (text) node where the selection begins. <strong>Read only.</strong></td>
  </tr>
  <tr>
   <td><code>focusNode</code></td>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIDOMNode" title="">nsIDOMNode</a></code></code></td>
   <td>Returns the node in which the selection ends. <strong>Read only.</strong></td>
  </tr>
  <tr>
   <td><code>focusOffset</code></td>
   <td><code><a title="en/long">long</a></code></td>
   <td>The offset within the (text) node where the selection ends. <strong>Read only.</strong></td>
  </tr>
  <tr>
   <td><code>isCollapsed</code></td>
   <td><code><a title="en/boolean">boolean</a></code></td>
   <td>Indicates if the selection is <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISelection#collapsed()">collapsed()</a></code> or not. <strong>Read only.</strong></td>
  </tr>
  <tr>
   <td><code>rangeCount</code></td>
   <td><code><a title="en/long">long</a></code></td>
   <td>Returns the number of ranges in the selection. <strong>Read only.</strong></td>
  </tr>
 </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<h3 id="addRange()" name="addRange()">addRange()</h3>
<p>Adds a <a href="/en-US/docs/Web/API/range">nsIDOMRange</a> to the current selection.</p>
<pre class="eval">void addRange(
  in nsIDOMRange range
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>range</code></dt>
 <dd>
  The <a href="/en-US/docs/Web/API/range">nsIDOMRange</a> to add</dd>
</dl>
<h3 id="collapse()" name="collapse()">collapse()</h3>
<p>Collapses the selection to a single point, at the specified offset in the given <a href="/en-US/docs/XPCOM_Interface_Reference/nsIDOMNode">nsIDOMNode</a>. When the selection is <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISelection#collapsed()">collapsed()</a></code>, and the content is focused and editable, the caret will blink there.</p>
<pre class="eval">void collapse(
  in nsIDOMNode parentNode,
  in long offset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>parentNode</code></dt>
 <dd>
  The given <a href="/en-US/docs/XPCOM_Interface_Reference/nsIDOMNode">nsIDOMNode</a> where the selection will be set.</dd>
 <dt>
  <code>offset</code></dt>
 <dd>
  Where in the given dom node to place the selection (the offset into the given node).</dd>
</dl>
<p></p><h3 id="collapsed()">collapsed()</h3><p></p>
<pre class="eval">[noscript,notxpcom,nostdcall] boolean collapsed();
</pre>
<p></p><div><span class="indicatorInHeadline noscript noscriptMethod" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span><h3 id="collapseNative">collapseNative</h3></div><p></p>
<p></p>
<pre class="eval">void collapseNative(
  in <a href="/en-US/docs/XPCOM_Interface_Reference/nsIDOMNode">nsINode</a> parentNode,
  in long offset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>parentNode</code></dt>
 <dt>
  <code>offset</code></dt>
</dl>
<p>collapseToEnd()</p>
<p>Collapses the whole selection to a single point at the end of the current selection (regardless of direction). If content is focused and editable, the caret will blink there.</p>
<pre class="eval">void collapseToEnd();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None</p>
<h3 id="collapseToStart()" name="collapseToStart()">collapseToStart()</h3>
<p>Collapses the whole selection to a single point at the start of the current selection (regardless of direction). If content is focused and editable, the caret will blink there.</p>
<pre class="eval">void collapseToStart();
</pre>
<h3 id="containsNode()" name="containsNode()">containsNode()</h3>
<p>Indicates whether the <a href="/en-US/docs/XPCOM_Interface_Reference/nsIDOMNode">nsIDOMNode</a> is part of the selection. If partlyContained is set to PR_TRUE, the function returns <code>true</code> when some part of the node is part of the selection. If partlyContained is set to PR_FALSE, the function only returns <code>true</code> when the entire node is part of the selection.</p>
<pre class="eval">boolean containsNode(
  in <a href="/en-US/docs/XPCOM_Interface_Reference/nsIDOMNode">nsIDOMNode</a> node,
  in boolean partlyContained
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>node</code></dt>
 <dd>
  The <a href="/en-US/docs/XPCOM_Interface_Reference/nsIDOMNode">nsIDOMNode</a> to look for</dd>
 <dt>
  <code>partlyContained</code></dt>
 <dd>
  If partlyContained is set to PR_FALSE, the function only returns <code>true</code> when the entire node is part of the selection.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Whether or not the range contains the requested noe.</p>
<h3 id="deleteFromDocument()" name="deleteFromDocument()">deleteFromDocument()</h3>
<p>Deletes this selection from the document the nodes belong to.</p>
<pre class="eval">void deleteFromDocument();
</pre>
<h3 id="extend()" name="extend()">extend()</h3>
<p>Extends the selection by moving the selection end to the specified <a href="/en-US/docs/XPCOM_Interface_Reference/nsIDOMNode">nsIDOMNode</a> and offset, preserving the selection begin position. The new selection end result will always be from the <code>anchorNode</code> to the new <code>focusNode</code>, regardless of direction.</p>
<pre class="eval">void extend(
  in <a href="/en-US/docs/XPCOM_Interface_Reference/nsIDOMNode">nsIDOMNode</a> parentNode,
  in long offset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>parentNode</code></dt>
 <dd>
  The node where the selection will be extended to.</dd>
 <dt>
  <code>offset</code></dt>
 <dd>
  Where in the node to place the offset in the new selection end.</dd>
</dl>
<p></p><div><span class="indicatorInHeadline noscript noscriptMethod" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span><h3 id="extendNative">extendNative</h3></div><p></p>
<p></p>
<pre class="eval">void extendNative(
  in <a href="/en-US/docs/XPCOM_Interface_Reference/nsIDOMNode">nsINode</a> parentNode,
  in long offset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>parentNode</code></dt>
 <dt>
  <code>offset</code></dt>
</dl>
<p>getRangeAt()</p>
<p>Returns the <a href="/en-US/docs/Web/API/range">nsIDOMRange</a> at the specified index.</p>
<pre class="eval">nsIDOMRange getRangeAt(
  in long index
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>index</code></dt>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>The <a href="/en-US/docs/Web/API/range">nsIDOMRange</a> requested</p>
<p></p><h3 id="modify()">modify()</h3><p></p>
<p>Modifies the selection. Note that the parameters are case-insensitive.</p>
<pre class="eval">void modify(
  in <a href="/en-US/docs/Web/API/DOMString">DOMString</a> alter,
  in <a href="/en-US/docs/Web/API/DOMString">DOMString</a> direction,
  in <a href="/en-US/docs/">DOMString</a> granularity
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>alter</code></dt>
 <dd>
  Can be one of { "move", "<code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISelection#extend()">extend()</a></code>" }
  <ul>
   <li>"move" collapses the selection to the end of the selection and applies the movement direction/granularity to the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISelection#collapsed()">collapsed()</a></code> selection.</li>
   <li>"<code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISelection#extend()">extend()</a></code>" leaves the start of the selection unchanged, and applies movement direction/granularity to the end of the selection.</li>
  </ul>
 </dd>
 <dt>
  <code>direction</code></dt>
 <dd>
  Can be one of { "forward", "backward", "left", "right" }</dd>
 <dt>
  <code>granularity</code></dt>
 <dd>
  Can be one of { "character", "word", "line", "lineboundary" }</dd>
</dl>
<h3 id="removeAllRanges()" name="removeAllRanges()">removeAllRanges()</h3>
<p>Removes all <a href="/en-US/docs/Web/API/range">nsIDOMRanges</a> from the current selection.</p>
<pre class="eval">void removeAllRanges();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None</p>
<h3 id="removeRange()" name="removeRange()">removeRange()</h3>
<p>Removes a range from the current selection.</p>
<pre class="eval">void removeRange(
  in <a href="/en-US/docs/Web/API/range">nsIDOMRange</a> range
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>range</code></dt>
</dl>
<h3 id="selectAllChildren()" name="selectAllChildren()">selectAllChildren()</h3>
<p>Adds all children of the specified node to the selection.</p>
<pre class="eval">void selectAllChildren(
  in <a href="/en-US/docs/XPCOM_Interface_Reference/nsIDOMNode">nsIDOMNode</a> parentNode
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>parentNode</code></dt>
 <dd>
  The parent of the children to be added to the selection.</dd>
</dl>
<h3 id="selectionLanguageChange()" name="selectionLanguageChange()">selectionLanguageChange()</h3>
<p>Modifies the cursor Bidi level after a change in keyboard direction.</p>
<pre class="eval">void selectionLanguageChange(
  in boolean langRTL
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>langRTL</code></dt>
 <dd>
  Is PR_TRUE if the new language is right-to-left or PR_FALSE if the new language is left-to-right.</dd>
</dl>
<h3 id="toString()" name="toString()">toString()</h3>
<p>Returns the whole selection into a plain text string.</p>
<pre class="eval"><a href="/en-US/docs/Web/API/DOMString">DOMString</a> toString();
</pre>
<h2 id="Remarks" name="Remarks">Remarks</h2>
<p> </p>
<h2 id="See_also" name="See_also">See also</h2>
<ul>
 <li> </li>
</ul></div><div id="footer"><hr/><p>This page was originally written for <a href="https://developer.mozilla.org">developer.mozilla.org</a> and is used here under the <a href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike license</a> (CC-BY-SA).</p>
<p>Original contributors to this page: <a href="https://developer.mozilla.org/en-US/profiles/wbamberg">wbamberg</a>, <a href="https://developer.mozilla.org/en-US/profiles/mdnwebdocs-bot">mdnwebdocs-bot</a>, <a href="https://developer.mozilla.org/en-US/profiles/Sheppy">Sheppy</a>, <a href="https://developer.mozilla.org/en-US/profiles/kscarfone">kscarfone</a>, <a href="https://developer.mozilla.org/en-US/profiles/wesj">wesj</a>, <a href="https://developer.mozilla.org/en-US/profiles/RealRaven2000">RealRaven2000</a>.</p></div></body>
</html>
