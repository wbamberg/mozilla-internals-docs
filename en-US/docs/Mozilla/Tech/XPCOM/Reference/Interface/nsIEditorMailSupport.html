<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/zilla-slab.css"/>
    <link rel="stylesheet" href="/css/page.css"/>
    <title>nsIEditorMailSupport</title>
  </head>

  <body><nav class="breadcrumbs"><a href="../../../../../Mozilla.html">Mozilla</a>&raquo;<a href="../../../../Tech.html">Tech</a>&raquo;<a href="../../../XPCOM.html">XPCOM</a>&raquo;<a href="../../Reference.html">Reference</a>&raquo;<a href="../Interface.html">Interface</a></nav><div class="content-heading"><h1>nsIEditorMailSupport</h1></div>
<div class="content"><p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/editor/idl/nsIEditorMailSupport.idl" rel="custom">editor/idl/nsIEditorMailSupport.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

Provides simple editing actions for the Thunderbird mail editor.
</span>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 1.7 </span></div>
</div><p></p>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table"> <tbody> <tr> <td><code>nsISupportsArray <a href="#getEmbeddedObjects()">getEmbeddedObjects</a>();</code></td> </tr> <tr> <td><code>nsIDOMNode <a href="#insertAsCitedQuotation()">insertAsCitedQuotation</a>(in AString aQuotedText, in AString aCitation, in boolean aInsertHTML);</code></td> </tr> <tr> <td><code>nsIDOMNode <a href="#insertAsQuotation()">insertAsQuotation</a>(in AString aQuotedText);</code></td> </tr> <tr> <td><code>void <a href="#insertTextWithQuotations()">insertTextWithQuotations</a>(in DOMString aStringToInsert);</code></td> </tr> <tr> <td><code>void <a href="#pasteAsCitedQuotation()">pasteAsCitedQuotation</a>(in AString aCitation, in long aSelectionType);</code></td> </tr> <tr> <td><code>void <a href="#pasteAsQuotation()">pasteAsQuotation</a>(in long aSelectionType);</code></td> </tr> <tr> <td><code>void <a href="#rewrap()">rewrap</a>(in boolean aRespectNewlines);</code></td> </tr> <tr> <td><code>void <a href="#stripCites()">stripCites</a>();</code></td> </tr> </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<h3 id="getEmbeddedObjects()" name="getEmbeddedObjects()">getEmbeddedObjects()</h3>
<p>Get a list of IMG and OBJECT tags in the current document.</p>
<pre class="eval">nsISupportsArray getEmbeddedObjects();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>An <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupportsArray" title="">nsISupportsArray</a></code> containing the IMG and OBJECT tags of the current document.</p>
<h3 id="insertAsCitedQuotation()" name="insertAsCitedQuotation()">insertAsCitedQuotation()</h3>
<p>Insert a string as quoted text (whose representation is dependent on the editor type), replacing the selected text (if any), including, if possible, a "cite" attribute.</p>
<pre class="eval">nsIDOMNode insertAsCitedQuotation(
  in AString aQuotedText,
  in AString aCitation,
  in boolean aInsertHTML
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aQuotedText</code></dt> <dd>The actual text to be quoted.</dd> <dt><code>aCitation</code></dt> <dd>The "mid" URL of the source message.</dd> <dt><code>aInsertHTML</code></dt> <dd>Insert as html? (vs plaintext)</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIDOMNode" title="">nsIDOMNode</a></code> which was inserted.</p>
<h3 id="insertAsQuotation()" name="insertAsQuotation()">insertAsQuotation()</h3>
<p>Insert a string as quoted text (whose representation is dependent on the editor type), replacing the selected text (if any).</p>
<pre class="eval">nsIDOMNode insertAsQuotation(
  in AString aQuotedText
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aQuotedText</code></dt> <dd>The actual text to be quoted.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIDOMNode" title="">nsIDOMNode</a></code> which was inserted.</p>
<h3 id="insertTextWithQuotations()" name="insertTextWithQuotations()">insertTextWithQuotations()</h3>
<p>Inserts a plain text string at the current location, with special processing for lines beginning with "&gt;", which will be treated as mail quotes and inserted as plain text quoted blocks. If the selection is not collapsed, the selection is deleted and the insertion takes place at the resulting collapsed selection.</p>
<pre class="eval">void insertTextWithQuotations(
  in DOMString aStringToInsert
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aStringToInsert</code></dt> <dd>The string to be inserted</dd>
</dl>
<h3 id="pasteAsCitedQuotation()" name="pasteAsCitedQuotation()">pasteAsCitedQuotation()</h3>
<p>Paste a string as quoted text, whose representation is dependent on the editor type, replacing the selected text (if any)</p>
<pre class="eval">void pasteAsCitedQuotation(
  in AString aCitation,
  in long aSelectionType
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aCitation</code></dt> <dd>The "mid" URL of the source message.</dd> <dt><code>aSelectionType</code></dt> <dd>Text or html?</dd>
</dl>
<h3 id="pasteAsQuotation()" name="pasteAsQuotation()">pasteAsQuotation()</h3>
<p>Paste the text in the OS clipboard at the cursor position, as a quotation (whose representation is dependent on the editor type), replacing the selected text (if any).</p>
<pre class="eval">void pasteAsQuotation(
  in long aSelectionType
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aSelectionType</code></dt> <dd>Text or html?</dd>
</dl>
<h3 id="rewrap()" name="rewrap()">rewrap()</h3>
<p>Rewrap the selected part of the document, re-quoting if necessary.</p>
<pre class="eval">void rewrap(
  in boolean aRespectNewlines
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aRespectNewlines</code></dt> <dd>Try to maintain newlines in the original?</dd>
</dl>
<h3 id="stripCites()" name="stripCites()">stripCites()</h3>
<p>Strip any citations in the selected part of the document.</p>
<pre class="eval">void stripCites();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p></div><div id="footer"><hr/><p>This page was originally written for <a href="https://developer.mozilla.org">developer.mozilla.org</a> and is used here under the <a href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike license</a> (CC-BY-SA).</p>
<p>Original contributors to this page: <a href="https://developer.mozilla.org/en-US/profiles/wbamberg">wbamberg</a>, <a href="https://developer.mozilla.org/en-US/profiles/Sheppy">Sheppy</a>, <a href="https://developer.mozilla.org/en-US/profiles/trevorh">trevorh</a>, <a href="https://developer.mozilla.org/en-US/profiles/Cancerbero%20sgx">Cancerbero sgx</a>.</p></div></body>
</html>
