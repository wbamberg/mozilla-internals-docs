<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/zilla-slab.css"/>
    <link rel="stylesheet" href="/css/page.css"/>
    <title>nsIINIParser</title>
  </head>

  <body><div class="content-heading"><h1>nsIINIParser</h1></div>
<div class="content"><p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/xpcom/ds/nsIINIParser.idl" rel="custom">xpcom/ds/nsIINIParser.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

An instance of <code>nsIINIParser</code> can be used to read values from an INI file.
</span>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 1.8 (Firefox 1.5 / Thunderbird 1.5 / SeaMonkey 1.0)</span></div>
</div><p></p>
<p>Typically, you'll create an <code>nsIINIParser</code> object by calling <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIINIParserFactory#createINIParser()">nsIINIParserFactory.createINIParser()</a></code>. Also, if you need to write to an INI file, use <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIINIParserWriter" title="">nsIINIParserWriter</a></code>.</p>
<table class="standard-table">
 <tbody>
  <tr>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUTF8StringEnumerator" title="">nsIUTF8StringEnumerator</a></code> <a href="/en/XPCOM_Interface_Reference/nsIINIParser#getKeys()" title="en/XPCOM Interface Reference/nsIINIParser#getKeys()">getKeys</a>(in AUTF8String aSection);</code></td>
  </tr>
  <tr>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUTF8StringEnumerator" title="">nsIUTF8StringEnumerator</a></code> <a href="/en/XPCOM_Interface_Reference/nsIINIParser#getSections()" title="en/XPCOM Interface Reference/nsIINIParser#getSections()">getSections</a>();</code></td>
  </tr>
  <tr>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/AUTF8String" title="">AUTF8String</a></code> <a href="/en/XPCOM_Interface_Reference/nsIINIParser#getString()" title="en/XPCOM Interface Reference/nsIINIParser#getString()">getString</a>(in AUTF8String aSection, in AUTF8String aKey);</code></td>
  </tr>
 </tbody>
</table>
<h2 id="Methods">Methods</h2>
<h3 id="eatCookie.28.29" name="eatCookie.28.29">getKeys()</h3>
<p>Returns an <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUTF8StringEnumerator" title="">nsIUTF8StringEnumerator</a></code> providing the keys available within the specified section of the INI file.</p>
<pre class="eval">nsIUTF8StringEnumerator getKeys(
  in AUTF8String aSection
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>aSection</code></dt>
 <dd>
  The name of the section whose keys you wish to enumerate.</dd>
</dl>
<h6 id="Return_value">Return value</h6>
<p>An <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUTF8StringEnumerator" title="">nsIUTF8StringEnumerator</a></code> object that can be used to access the section's keys.</p>
<h3 id="getSections()">getSections()</h3>
<p>Returns an <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUTF8StringEnumerator" title="">nsIUTF8StringEnumerator</a></code> providing a list of the sections available within the INI file.</p>
<pre>nsIUTF8StringEnumerator getSections();
</pre>
<h6 id="Parameters_2">Parameters</h6>
<p>None.</p>
<h6 id="Return_value_2">Return value</h6>
<p>An <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUTF8StringEnumerator" title="">nsIUTF8StringEnumerator</a></code> object that can be used to access the sections in the INI file.</p>
<h3 id="getString()">getString()</h3>
<p>Returns the string value for the specified key within a particular section of the INI file.</p>
<pre>AUTF8String getString(
  in AUTF8String aSection,
  in AUTF8String aKey
);
</pre>
<h6 id="Parameters_3">Parameters</h6>
<dl>
 <dt>
  <code>aSection</code></dt>
 <dd>
  The section containing the key whose value is to be returned.</dd>
 <dt>
  <code>aKey</code></dt>
 <dd>
  The key for which the value should be returned.</dd>
</dl>
<h6 id="Return_value_3">Return value</h6>
<p>The string value of the specified key.</p>
<h2 id="Examples">Examples</h2>
<h3 id="Getting_a_value_for_a_key">Getting a value for a key</h3>
<p>This example provides a function you can call to obtain the value for a specific key in a given INI file.</p>
<pre>/**
 * Returns the value for a given property in an INI file
 * @param {nsIFile} iniFile
 *   The ini file to get the value from
 * @param {String} section
 *   The name of the section in the ini file. INI sections are
 *   defined by square brakets and look like this: [Settings]
 *   All entries below such a section definition belong to that
 *   section (until the next section).
 * @param {String} prop
 *   The name of the property to get.
 */
function getIniValue (iniFile, section, prop) {
  var iniFact = Components.manager.getClassObjectByContractID(
    "@mozilla.org/xpcom/ini-parser-factory;1",
    Components.interfaces.nsIINIParserFactory
  );
  var iniParser = iniFact.createINIParser(iniFile);
  try {
    return iniParser.getString(section,prop);
  }
  catch(e) {
    return undefined;
  }
}

// Usage:
var lang = getIniValue(file,"Setting","Language"); 
</pre>
<h3 id="Enumerating_sections">Enumerating sections</h3>
<p>This example gets a list of all the sections in the INI file.</p>
<pre>// get all sections in the ini file
var sectEnum = iniParser.getSections();
// save the sections in an array
var sections = [];
while (sectEnum &amp;&amp; sectEnum.hasMore()) {
  var section = sectEnum.getNext();
  // add an array entry for each section
  sections.push(section);
}
</pre>
<h3 id="Enumerating_keys">Enumerating keys</h3>
<p>This example shows how to fetch the values for all the keys in the section named "Setting".</p>
<pre>// get all keys for the "Setting" section
var keysEnum = iniParser.getKeys("Setting");
// save the keys and values in an object
var keys = {};
while (keysEnum &amp;&amp; keysEnum.hasMore()) {
  var key = keysEnum.getNext();
  // create a property for each key and assing the ini value.
  keys[key] = iniParser.getString("Setting", key);
} </pre>
<h3 id="See_Also" name="See_Also">See Also</h3>
<ul>
 <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIINIParserFactory" title="">nsIINIParserFactory</a></code></li>
 <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIINIParserWriter" title="">nsIINIParserWriter</a></code></li>
</ul></div><div id="footer"><hr/><p>This page was originally written for <a href="https://developer.mozilla.org">developer.mozilla.org</a> and is used here under the <a href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike license</a> (CC-BY-SA).</p>
<p>Original contributors to this page: <a href="https://developer.mozilla.org/en-US/profiles/wbamberg">wbamberg</a>, <a href="https://developer.mozilla.org/en-US/profiles/mdnwebdocs-bot">mdnwebdocs-bot</a>, <a href="https://developer.mozilla.org/en-US/profiles/Sheppy">Sheppy</a>, <a href="https://developer.mozilla.org/en-US/profiles/Yuan.Xulei">Yuan.Xulei</a>, <a href="https://developer.mozilla.org/en-US/profiles/jhammel">jhammel</a>, <a href="https://developer.mozilla.org/en-US/profiles/Kirschkern">Kirschkern</a>.</p></div></body>
</html>
