<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/zilla-slab.css"/>
    <link rel="stylesheet" href="/css/page.css"/>
    <title>NS_InitXPCOM3</title>
  </head>

  <body><nav class="breadcrumbs"><a href="../../../../../Mozilla.html">Mozilla</a>&raquo;<a href="../../../../Tech.html">Tech</a>&raquo;<a href="../../../XPCOM.html">XPCOM</a>&raquo;<a href="../../Reference.html">Reference</a>&raquo;<a href="../Core_functions.html">Core_functions</a></nav><div class="content-heading"><h1>NS_InitXPCOM3</h1></div>
<div class="content"><p>
 «
 <a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference">
  XPCOM API Reference
 </a>
</p>
<h3 id="Summary" name="Summary">
 Summary
</h3>
<p>
 The
 <code>
  NS_InitXPCOM3
 </code>
 function initiates use of XPCOM in the calling process with support for statically defined XPCOM modules.
</p>
<pre class="eval">#include "nsXPCOM.h"
 
nsresult NS_InitXPCOM3(
  nsIServiceManager** <var>aResult</var>,
  nsIFile* <var>aBinDirectory</var>,
  nsIDirectoryServiceProvider* <var>aAppFileLocationProvider</var>,
  nsStaticModuleInfo const* <var>aStaticModules</var>,
  PRUint32 <var>aStaticModuleCount</var>
);
</pre>
<h3 id="Parameters" name="Parameters">
 Parameters
</h3>
<dl>
 <dt>
  aResult
 </dt>
 <dd>
  [out] The resulting XPCOM service manager. You may pass null if you are not interested in this return value. The service manager may alternatively be accessed by calling
  <code>
   <a href="en/NS_GetServiceManager">
    NS_GetServiceManager
   </a>
  </code>
  . The resulting interface pointer is
  <code>
   AddRef
  </code>
  'd upon return and must either be
  <code>
   Release
  </code>
  'd explicitly or passed to
  <code>
   <a href="en/NS_ShutdownXPCOM">
    NS_ShutdownXPCOM
   </a>
  </code>
  when the application is finished with XPCOM.
 </dd>
</dl>
<dl>
 <dt>
  aBinDirectory
 </dt>
 <dd>
  [in] The directory containing the component registry and runtime libraries. Pass null to specify that the current working directory should be used.
 </dd>
</dl>
<dl>
 <dt>
  aAppFileLocationProvider
 </dt>
 <dd>
  [in] The object to be used by XPCOM to locate application specific directories and files (e.g., the user profile, the component registry, etc.). This parameter may be
  <code>
   nsnull
  </code>
  .
 </dd>
</dl>
<dl>
 <dt>
  aStaticModules
 </dt>
 <dd>
  [in] An array of
  <a href="en/NsStaticModuleInfo">
   nsStaticModuleInfo
  </a>
  objects. Passing null causes the default (built-in) static modules to be registered, if present.
 </dd>
</dl>
<dl>
 <dt>
  aStaticModuleCount
 </dt>
 <dd>
  [in] The number of elements in
  <var>
   aStaticModules
  </var>
  .
 </dd>
</dl>
<h3 id="Return_Values" name="Return_Values">
 Return Values
</h3>
<p>
 The
 <code>
  NS_InitXPCOM3
 </code>
 function returns
 <code>
  NS_OK
 </code>
 if successful. Otherwise, it returns an error code. Some of the possible errors are documented below:
</p>
<dl>
 <dt>
  NS_ERROR_NOT_INITIALIZED
 </dt>
 <dd>
  Indicates that static globals were not yet initialized, which may happen if this method is called before XPCOM's static initialization code executes. This error may also occur if XPCOM is being initialized after
  <code>
   <a href="en/NS_ShutdownXPCOM">
    NS_ShutdownXPCOM
   </a>
  </code>
  has been called.
 </dd>
</dl>
<h3 id="Remarks" name="Remarks">
 Remarks
</h3>
<p>
 You must call
 <code>
  NS_InitXPCOM3
 </code>
 (or
 <code>
  <a href="en/NS_InitXPCOM2">
   NS_InitXPCOM2
  </a>
 </code>
 ) before proceeding to use XPCOM in a process. The one exception is that you may call
 <code>
  <a href="en/NS_NewLocalFile">
   NS_NewLocalFile
  </a>
 </code>
 or
 <code>
  <a href="en/NS_NewNativeLocalFile">
   NS_NewNativeLocalFile
  </a>
 </code>
 to create a
 <code>
  <a href="en/NsIFile">
   nsIFile
  </a>
 </code>
 needed for the
 <var>
  aBinDirectory
 </var>
 parameter to
 <code>
  NS_InitXPCOM3
 </code>
 . Many of the XPCOM glue functions and classes are also available prior to XPCOM initialization, including for example
 <code>
  <a href="en/NsEmbedCString">
   nsEmbedCString
  </a>
 </code>
 and
 <code>
  <a href="en/NsCOMPtr">
   nsCOMPtr
  </a>
 </code>
 .
</p>
<p>
 Initializing XPCOM with static modules allows the application to easily define modules that are linked into the application's executable. This can be a performance improvement over dynamically loaded XPCOM modules.
</p>
<h3 id="History" name="History">
 History
</h3>
<p>
 This function was finalized for Mozilla 1.8. See
 <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=296561" title="FIXED: Make it possible to access nsIXULRuntime during xpcom-startup event">
  bug 296561
 </a>
 for details.
</p>
<h3 id="See_Also" name="See_Also">
 See Also
</h3>
<p>
 <code>
  <a href="en/NS_InitXPCOM2">
   NS_InitXPCOM2
  </a>
 </code>
 ,
 <code>
  <a href="en/NS_ShutdownXPCOM">
   NS_ShutdownXPCOM
  </a>
 </code>
</p></div><div id="footer"><hr/><p>This page was originally written for <a href="https://developer.mozilla.org">developer.mozilla.org</a> and is used here under the <a href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike license</a> (CC-BY-SA).</p>
<p>Original contributors to this page: <a href="https://developer.mozilla.org/en-US/profiles/wbamberg">wbamberg</a>, <a href="https://developer.mozilla.org/en-US/profiles/Sheppy">Sheppy</a>, <a href="https://developer.mozilla.org/en-US/profiles/DarinFisher">DarinFisher</a>, <a href="https://developer.mozilla.org/en-US/profiles/Nickolay">Nickolay</a>.</p></div></body>
</html>
