{
    "content": "<p><a href=\"/en-US/docs/Accessibility/AT-APIs#Supported_AT_APIs\">« AT APIs Support Page</a></p>\n\n<h2 id=\"Introduction\" name=\"Introduction\">Introduction</h2>\n\n<p>To use MSAA with Gecko, you'll need the tools and docs that come with the <a class=\"external\" href=\"http://www.microsoft.com/downloads/details.aspx?FamilyId=3755582A-A707-460A-BF21-1373316E13F0&amp;displaylang=en\">Active Accessibility 2.0 SDK Tools</a>. The method <code>AccessibleObjectFromWindow()</code> will get you the root IAccessible corresponding to the top level window. Hold on to this root IAccessible, and use it to walk through the entire tree of IAccessible's.</p>\n\n<h2 id=\"IAccessible_Overview\" name=\"IAccessible_Overview\">IAccessible Overview</h2>\n\n<p>Refer to original <a class=\"external\" href=\"http://msdn2.microsoft.com/en-us/library/ms696165.aspx\">specification</a> to get more information about <code>IAccessible</code> interface.</p>\n\n<table style=\"width: 100%;\">\n <tbody>\n  <tr>\n   <th>MSAA</th>\n   <th>Description</th>\n   <th>Gecko</th>\n  </tr>\n  <tr>\n   <td>accDoDefaultAction</td>\n   <td>Performs the specified object's default action</td>\n   <td><code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#doAction()\">nsIAccessible.doAction()</a></code></td>\n  </tr>\n  <tr>\n   <td>accHitTest</td>\n   <td>Retrieves the child element or child object at a given point on the screen</td>\n   <td><code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#getChildAtPoint()\">nsIAccessible.getChildAtPoint()</a></code></td>\n  </tr>\n  <tr>\n   <td>accLocation</td>\n   <td>Retrieves the specified object's current screen location</td>\n   <td><code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#getBounds()\">nsIAccessible.getBounds()</a></code></td>\n  </tr>\n  <tr>\n   <td><a href=\"#accNavigate\">accNavigate</a></td>\n   <td>Traverses to another user interface (UI) element within a container and retrieves the object</td>\n   <td>complex mapping</td>\n  </tr>\n  <tr>\n   <td><a href=\"#accSelect\">accSelect</a></td>\n   <td>Modifies the selection or moves the keyboard focus of the specified object</td>\n   <td>complex mapping</td>\n  </tr>\n  <tr>\n   <td>get_accChild</td>\n   <td>Retrieves an <code>IDispatch</code> interface pointer for the specified child, if one exists</td>\n   <td><code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#getChildAt()\">nsIAccessible.getChildAt()</a></code></td>\n  </tr>\n  <tr>\n   <td>get_accChildCount</td>\n   <td>Retrieves the number of children that belong to this object. All objects must support this property</td>\n   <td><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#childCount\">nsIAccessible.childCount</a></td>\n  </tr>\n  <tr>\n   <td>get_accDefaultAction</td>\n   <td>Retrieves a string that describes the object's default action.</td>\n   <td><code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#getActionName()\">nsIAccessible.getActionName()</a></code></td>\n  </tr>\n  <tr>\n   <td>get_accDescription</td>\n   <td>retrieves a string that describes the visual appearance of the specified object.</td>\n   <td><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#description\">nsIAccessible.description</a></td>\n  </tr>\n  <tr>\n   <td>get_accFocus</td>\n   <td>Returns the localized extended role</td>\n   <td><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#focusedChild\">nsIAccessible.focusedChild</a></td>\n  </tr>\n  <tr>\n   <td>get_accHelp</td>\n   <td>Retrieves an object's Help property string.</td>\n   <td>not supported</td>\n  </tr>\n  <tr>\n   <td>get_accHelpTopic</td>\n   <td>Retrieves the full path of the WinHelp file associated with the specified object and the identifier of the appropriate topic within that file.</td>\n   <td>not supported</td>\n  </tr>\n  <tr>\n   <td>get_accKeyboardShortcut</td>\n   <td>Retrieves the specified object's shortcut key or access key, also known as the mnemonic.</td>\n   <td><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#keyboardShortcut\">nsIAccessible.keyboardShortcut</a></td>\n  </tr>\n  <tr>\n   <td><a href=\"#get_accName\">get_accName</a></td>\n   <td>Retrieves the name of the specified object. All objects support this property.</td>\n   <td><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#name\">nsIAccessible.name</a></td>\n  </tr>\n  <tr>\n   <td>get_accParent</td>\n   <td>Retrieves the IDispatch interface of the object's parent.</td>\n   <td><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#parent\">nsIAccessible.parent</a></td>\n  </tr>\n  <tr>\n   <td>get_accRole</td>\n   <td>Retrieves information that describes the role of the specified object.</td>\n   <td><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#role\">nsIAccessible.role</a></td>\n  </tr>\n  <tr>\n   <td>get_accSelection</td>\n   <td>Retrieves the selected children of this object.</td>\n   <td><code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessibleSelectable#getSelectedChildren()\">nsIAccessibleSelectable.getSelectedChildren()</a></code></td>\n  </tr>\n  <tr>\n   <td>get_accState</td>\n   <td>Retrieves the current state of the specified object.</td>\n   <td><code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#getStates()\">nsIAccessible.getStates()</a></code></td>\n  </tr>\n  <tr>\n   <td>get_accValue</td>\n   <td>Retrieves the value of the specified object.</td>\n   <td><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#value\">nsIAccessible.value</a></td>\n  </tr>\n </tbody>\n</table>\n\n<h2 id=\"IAccessible_Details\" name=\"IAccessible_Details\">IAccessible Details</h2>\n\n<h3 id=\"accNavigate\" name=\"accNavigate\">accNavigate</h3>\n\n<h4 id=\"Summary\" name=\"Summary\">Summary</h4>\n\n<p>Traverses to another user interface (UI) element within a container and retrieves the object (see <a href=\"https://docs.microsoft.com/en-us/previous-versions//ms696145(v=vs.85)\"><code>IAccessible::accNavigate</code> on MSDN</a>).</p>\n\n<pre>HRESULT accNavigate(\n  long navDir,\n  VARIANT varStart,\n  VARIANT* pvarEnd\n);\n</pre>\n\n<p>The traversed object depends on the given constant <code>navDir</code>. Refer to the <a href=\"/en/Accessibility/AT-APIs/MSAA/Relations\" title=\"en/Accessibility/AT-APIs/MSAA/Relations\">supported constants</a>.</p>\n\n<h3 id=\"accSelect\" name=\"accSelect\">accSelect</h3>\n\n<h4 id=\"Summary_2\" name=\"Summary_2\">Summary</h4>\n\n<p>Modifies the selection or moves the keyboard focus of the specified object (see <a href=\"https://docs.microsoft.com/en-us/previous-versions//ms697291(v=vs.85)\"><code>IAccessible::accSelect</code> on MSDN</a>).</p>\n\n<pre>HRESULT accSelect(\n  long flagsSelect,\n  VARIANT varID\n);\n</pre>\n\n<h4 id=\"Implementation\" name=\"Implementation\">Implementation</h4>\n\n<p>Depending on <code>flagsSelect</code> argument (see <a href=\"https://docs.microsoft.com/en-us/previous-versions//ms696148(v=vs.85)\">SELFFLAG on MSDN</a>) the method is mapped to Gecko methods by the following way:</p>\n\n<table class=\"standard-table\">\n <tbody>\n  <tr>\n   <th><code>flagsSelect</code></th>\n   <th>Description</th>\n   <th>Gecko</th>\n  </tr>\n  <tr>\n   <td><code>SELFLAG_TAKEFOCUS</code></td>\n   <td>Sets the focus to the object</td>\n   <td><code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#takeFocus()\">nsIAccessible.takeFocus()</a></code></td>\n  </tr>\n  <tr>\n   <td><code>SELFLAG_TAKESELECTION</code></td>\n   <td>Selects the object and removes the selection from all other objects in the container.</td>\n   <td><code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#takeSelection()\">nsIAccessible.takeSelection()</a></code></td>\n  </tr>\n  <tr>\n   <td><code>SELFLAG_ADDSELECTION</code></td>\n   <td>Adds the object to the current selection</td>\n   <td><code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#setSelected()\">nsIAccessible.setSelected()</a></code></td>\n  </tr>\n  <tr>\n   <td><code>SELFLAG_REMOVESELECTION</code></td>\n   <td>Removes the object from the current selection</td>\n   <td><code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#setSelected()\">nsIAccessible.setSelected()</a></code></td>\n  </tr>\n  <tr>\n   <td><code>SELFLAG_EXTENDSELECTION</code></td>\n   <td>Alters the selection so that all objects between the selection anchor and this object take on the anchor object's selection state.</td>\n   <td><code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessible#extendSelection()\">nsIAccessible.extendSelection()</a></code></td>\n  </tr>\n </tbody>\n</table>\n\n<h3 id=\"get_accName\" name=\"get_accName\">get_accName</h3>\n\n<h4 id=\"Summary_3\" name=\"Summary_3\">Summary</h4>\n\n<p>Retrieves the name of the specified object (see <a href=\"https://docs.microsoft.com/en-us/previous-versions//ms696177(v=vs.85)\"><code>IAccessible::get_accName</code> on MSDN</a>).</p>\n\n<pre>HRESULT get_accName(\n  VARIANT varID,\n  BSTR* pszName\n);\n</pre>\n\n<h4 id=\"Return_values\" name=\"Return_values\">Return values</h4>\n\n<dl>\n <dt>If there is not name</dt>\n <dd><code>S_OK</code> and <code>*pszName == NULL</code></dd>\n <dd> </dd>\n <dd>For example, when <code>alt</code> attribute isn't presented and <code>title</code> or ARIA attributes aren't specified or empty on <code>html:img</code> element.</dd>\n</dl>\n\n<dl>\n <dt>If there is a name (possibly empty)</dt>\n <dd><code>S_OK</code> and <code>*pszName != NULL</code></dd>\n <dd> </dd>\n <dd>The empty name means we allocate the string by <code> SysAllocStringLen(\"\", 0)</code> method. You can get empty name, when, for example, <code>html:img</code> has only <code>alt</code> attribute with empty value (<code><span class=\"nowiki\">&lt;img alt = \"\" &gt;</span></code>).</dd>\n</dl>\n\n<dl>\n <dt>If error occured</dt>\n <dd><code>E_FAIL</code></dd>\n</dl>",
    "contributors": "<a href=\"https://developer.mozilla.org/en-US/profiles/wbamberg\">wbamberg</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/ExE-Boss\">ExE-Boss</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/mdnwebdocs-bot\">mdnwebdocs-bot</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/SphinxKnight\">SphinxKnight</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Sheppy\">Sheppy</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Surkov.alexander\">Surkov.alexander</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/George3\">George3</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Aaronlev\">Aaronlev</a>",
    "title": "Supported MSAA Interfaces"
}