{
    "content": "<div class=\"note\">\n <p>I just had to use the Password Manager for a project I was working on, so I thought I'd braindump my notes to the wiki while I was at it. This code is tested, but barely, and I am by no means an expert on this area. Review and cleanup would be appreciated. <a href=\"/User:Zachlipton\" title=\"User:Zachlipton\">Zachlipton</a> 22:52, 18 July 2006 (PDT)</p>\n</div>\n<p>The code on this page will work with applications using Toolkit 1.8 and below such as Firefox 2.0.0.x and Thunderbird 2.0.0.x. For similar functionality in Toolkit 1.9, see <a href=\"/en/XPCOM_Interface_Reference/Using_nsILoginManager\" title=\"en/XPCOM_Interface_Reference/Using_nsILoginManager\">Using nsILoginManager</a>.</p>\n<h3 id=\"Working_with_Password_Manager\" name=\"Working_with_Password_Manager\">Working with Password Manager</h3>\n<p>Extensions often need to securely store passwords to external sites, web applications, and so on. To do so securely, they can use <code><a href=\"/en/nsIPasswordManager\" title=\"en/nsIPasswordManager\">nsIPasswordManager</a></code>, which provides for secure storage of sensitive password information.</p>\n<h3 id=\"Getting_nsIPasswordManager\" name=\"Getting_nsIPasswordManager\">Getting <code>nsIPasswordManager</code></h3>\n<p>To get a component implementing <code>nsIPasswordManager</code>, use the following:</p>\n<pre>var passwordManager = Components.classes[\"@mozilla.org/passwordmanager;1\"]\n                                .getService(Components.interfaces.nsIPasswordManager);\n</pre>\n<h3 id=\"Storing_a_password\" name=\"Storing_a_password\">Storing a password</h3>\n<p>To store a password in the password manager, you need three things: a hostname/URL (you'll need this to retrieve the password again later), a username, and a password. Of this information, the password is the only data that will be stored securely. Adding a password to the password manager is easy:</p>\n<pre class=\"eval\">passwordManager.addUser('host', 'username', 'password');\n</pre>\n<p>Since there's no provision to include names of HTML input fields, no password stored by this interface will be used to fill in passwords on web pages. <a href=\"/en/XPCOM_Interface_Reference/nsILoginManager\" title=\"en/XPCOM_Interface_Reference/nsILoginManager\">nsILoginManager</a>, available in Toolkit 1.9, does let you include input field names.</p>\n<h3 id=\"Retrieving_a_password\" name=\"Retrieving_a_password\">Retrieving a password</h3>\n<p>Retrieving a password from the password manager is more difficult. The example below should serve as a starting point:</p>\n<pre>// the host name of the password we are looking for\nvar queryString = 'http://www.example.com';\n// ask the password manager for an enumerator:\nvar e = passwordManager.enumerator;\n// step through each password in the password manager until we find the one we want:\nwhile (e.hasMoreElements()) {\n    try {\n        // get an nsIPassword object out of the password manager.\n        // This contains the actual password...\n        var pass = e.getNext().QueryInterface(Components.interfaces.nsIPassword);\n        if (pass.host == queryString) {\n             // found it!\n             alert(pass.user); // the username\n             alert(pass.password); // the password\n             break;\n        }\n    } catch (ex) {\n        // do something if decrypting the password failed--probably a continue\n    }\n}\n</pre>\n<p>Note that the user will be prompted for their master password if they have chosen to set one to secure their passwords.</p>\n<h3 id=\"Removing_a_password\" name=\"Removing_a_password\">Removing a password</h3>\n<pre>passwordManager.removeUser('host','username');\n</pre>",
    "contributors": "<a href=\"https://developer.mozilla.org/en-US/profiles/wbamberg\">wbamberg</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/teoli\">teoli</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/kscarfone\">kscarfone</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/ericpp\">ericpp</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Np\">Np</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Nickolay\">Nickolay</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Zachlipton\">Zachlipton</a>",
    "title": "Using nsIPasswordManager"
}