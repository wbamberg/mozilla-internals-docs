{
    "content": "<p>Objects that implements <code>nsIMsgMessageService</code> give the user top level routines related to messages like copying, displaying, attachment's manipulation, printing, streaming the message content to <code><a href=\"/en/Eml\" title=\"en/Eml\">eml</a></code> format string, etc.</p>\n\n<p>Inherits from: <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports\" title=\"\">nsISupports</a></code></p>\n\n<h2 id=\"Method_overview\" name=\"Method_overview\">Method overview</h2>\n\n<table class=\"standard-table\">\n <tbody>\n  <tr>\n   <td><code>void <a href=\"#CopyMessage()\">CopyMessage</a>(in string aSrcURI, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIStreamListener\" title=\"\">nsIStreamListener</a></code> aCopyListener, in boolean aMoveMessage, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> aUrlListener, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow, out <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> aURL);</code></td>\n  </tr>\n  <tr>\n   <td><code>[noscript] void <a href=\"#CopyMessages()\">CopyMessages</a>(in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgKeyArrayPtr\" title=\"\">nsMsgKeyArrayPtr</a></code> keys, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgFolder\" title=\"\">nsIMsgFolder</a></code> srcFolder, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIStreamListener\" title=\"\">nsIStreamListener</a></code> aCopyListener, in boolean aMoveMessage, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> aUrlListener, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow, out nsIURI aURL);</code></td>\n  </tr>\n  <tr>\n   <td><code>void <a href=\"#DisplayMessage()\">DisplayMessage</a>(in string aMessageURI, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports\" title=\"\">nsISupports</a></code> aDisplayConsumer, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> aUrlListener, in string aCharsetOverride, out <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> aURL);</code></td>\n  </tr>\n  <tr>\n   <td><code>void <a href=\"#openAttachment()\">openAttachment</a>(in string aContentType, in string aFileName, in string aUrl, in string aMessageUri, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports\" title=\"\">nsISupports</a></code> aDisplayConsumer, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> aUrlListener);</code></td>\n  </tr>\n  <tr>\n   <td><code>void <a href=\"#SaveMessageToDisk()\">SaveMessageToDisk</a>(in string aMessageURI, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIFileSpec\" title=\"\">nsIFileSpec</a></code> aFile, in boolean aGenerateDummyEnvelope, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> aUrlListener, out <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> aURL, in boolean canonicalLineEnding, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow);</code></td>\n  </tr>\n  <tr>\n   <td><code>void <a href=\"#GetUrlForUri()\">GetUrlForUri</a>(in string aMessageURI, out <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> aURL, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow);</code></td>\n  </tr>\n  <tr>\n   <td><code>void <a href=\"#DisplayMessageForPrinting()\">DisplayMessageForPrinting</a>(in string aMessageURI, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports\" title=\"\">nsISupports</a></code> aDisplayConsumer, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> aUrlListener, out <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> aURL);</code></td>\n  </tr>\n  <tr>\n   <td><code>void <a href=\"#Search()\">Search</a>(in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgSearchSession\" title=\"\">nsIMsgSearchSession</a></code> aSearchSession, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgFolder\" title=\"\">nsIMsgFolder</a></code> aMsgFolder, in string aSearchUri);</code></td>\n  </tr>\n  <tr>\n   <td><code><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> <a href=\"#streamMessage()\">streamMessage</a>(<code>in string aMessageURI, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports\" title=\"\">nsISupports</a></code> aConsumer, </code>in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> aUrlListener, in boolean aConvertData, in string aAdditionalHeader);</code></td>\n  </tr>\n  <tr>\n   <td><code><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> <a href=\"#streamHeaders()\">streamHeaders</a>(</code><code>in string aMessageURI, in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIStreamListener\" title=\"\">nsIStreamListener</a></code> aConsumer, </code><code>in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> aUrlListener [optional] in boolean aLocalOnly);</code></td>\n  </tr>\n  <tr>\n   <td><code>boolean <a href=\"#isMsgInMemCache()\">isMsgInMemCache</a>(in <code><code><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/&lt;/code>&lt;/code>nsIURI\" title=\"\"></a></code></code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/&lt;/code>&lt;/code>nsIURI\" title=\"\">nsIURI</a></code> aURL</code>,  <code>in <code><code><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/&lt;/code>&lt;/code>nsIMsgFolder\" title=\"\"></a></code></code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/&lt;/code>&lt;/code>nsIMsgFolder\" title=\"\">nsIMsgFolder</a></code> aFolder, out </code> <code><code><code><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/&lt;/code>&lt;/code>nsICacheEntryDescriptor\" title=\"\"></a></code></code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/&lt;/code>&lt;/code>nsICacheEntryDescriptor\" title=\"\">nsICacheEntryDescriptor</a></code> aCacheEntry);</code></td>\n  </tr>\n  <tr>\n   <td><code><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgDBHdr\" title=\"\">nsIMsgDBHdr</a></code> <a href=\"#messageURIToMsgHdr()\">messageURIToMsgHdr</a>(in string uri);</code></td>\n  </tr>\n </tbody>\n</table>\n\n<h2 id=\"Methods\">Methods</h2>\n\n<h3 id=\"CopyMessage()\">CopyMessage()</h3>\n\n<p>Pass in the URI for the message you want to have copied. <code>aCopyListener</code> already knows about the destination folder.</p>\n\n<pre class=\"eval\"> void CopyMessage(in string aSrcURI,\n                  in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIStreamListener\" title=\"\">nsIStreamListener</a></code> aCopyListener, \n                  in boolean aMoveMessage,\n                  in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> aUrlListener, \n                  in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow,\n                  out nsIURI aURL);\n</pre>\n\n<h6 id=\"Parameters\" name=\"Parameters\">Parameters</h6>\n\n<dl>\n <dt><code>aSrcURI</code></dt>\n <dd>The string <code>url</code> of the message to copy.</dd>\n <dt><code>aCopyListener</code></dt>\n <dd>An <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIStreamListener\" title=\"\">nsIStreamListener</a></code> to be notified of copy events.</dd>\n <dt><code>aMoveMessage</code></dt>\n <dd>Set to <code>true</code> if you want the message to be moved. <code>false</code> leaves it as just a copy.</dd>\n <dt><code>aUrlListener</code></dt>\n <dd>A <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> to be notified of url events.</dd>\n <dt><code>aMsgWindow</code></dt>\n <dd><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> for progress and status feedback</dd>\n</dl>\n\n<h6 id=\"Return_values\" name=\"Return_values\">Return values</h6>\n\n<dl>\n <dt><code>aURL</code></dt>\n <dd>The new <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> of the message.</dd>\n</dl>\n\n<h3 id=\"CopyMessages()\">CopyMessages()</h3>\n\n<p>Copy multiple messages at a time. See <a href=\"#CopyMessage()\">CopyMessage</a></p>\n\n<pre class=\"eval\"> [noscript] void CopyMessages(in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgKeyArrayPtr\" title=\"\">nsMsgKeyArrayPtr</a></code> keys,\n                              in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgFolder\" title=\"\">nsIMsgFolder</a></code> srcFolder, \n                              in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIStreamListener\" title=\"\">nsIStreamListener</a></code> aCopyListener,\n                              in boolean aMoveMessage, \n                              in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> aUrlListener,\n                              in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow, \n                              out nsIURI aURL);\n</pre>\n\n<h6 id=\"Parameters_2\" name=\"Parameters_2\">Parameters</h6>\n\n<dl>\n <dt><code>keys</code></dt>\n <dd>An array of message keys to be copied.</dd>\n <dt><code>srcFolder</code></dt>\n <dd> </dd>\n <dt><code>aCopyListener</code></dt>\n <dd>An <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIStreamListener\" title=\"\">nsIStreamListener</a></code> to be notified of copy events.</dd>\n <dt><code>aMoveMessage</code></dt>\n <dd>Set to <code>true</code> if you want the message to be moved. <code>false</code> leaves it as just a copy.</dd>\n <dt><code>aUrlListener</code></dt>\n <dd>An <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code></dd>\n <dt><code>aMsgWindow</code></dt>\n <dd><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> for progress and status feedback</dd>\n</dl>\n\n<h6 id=\"Return_values_2\" name=\"Return_values_2\">Return values</h6>\n\n<dl>\n <dt><code>aURL</code></dt>\n <dd>The new <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> of the message. (?)</dd>\n</dl>\n\n<h3 id=\"DisplayMessage()\">DisplayMessage()</h3>\n\n<p>When you want a message displayed....</p>\n\n<pre class=\"eval\"> void DisplayMessage(in string aMessageURI,\n                     in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports\" title=\"\">nsISupports</a></code> aDisplayConsumer, \n                     in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow,\n                     in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> aUrlListener, \n                     in string aCharsetOverride,\n                     out <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> aURL);\n</pre>\n\n<h6 id=\"Parameters_3\" name=\"Parameters_3\">Parameters</h6>\n\n<dl>\n <dt><code>aMessageURI</code></dt>\n <dd>A uri representing the message to display.</dd>\n <dt><code>aDisplayConsumer</code></dt>\n <dd>Is (for now) an <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIDocShell\" title=\"\">nsIDocShell</a></code> which the message is loaded into.</dd>\n <dt><code>aMsgWindow</code></dt>\n <dd><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> for progress and status feedback</dd>\n <dt><code>aUrlListener</code></dt>\n <dd>An <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code></dd>\n <dt><code>aCharsetOverride</code></dt>\n <dd>(optional) character set over ride to force the message to use.</dd>\n</dl>\n\n<h6 id=\"Return_values_3\" name=\"Return_values_3\">Return values</h6>\n\n<dl>\n <dt><code>aURL</code></dt>\n <dd>The new <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> of the message.</dd>\n</dl>\n\n<h3 id=\"openAttachment()\">openAttachment()</h3>\n\n<p>Downloads and opens an attachment.</p>\n\n<pre class=\"eval\"> void openAttachment(in string aContentType,\n                     in string aFileName,\n                     in string aUrl, \n                     in string aMessageUri,\n                     in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports\" title=\"\">nsISupports</a></code> aDisplayConsumer, \n                     in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow,\n                     in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> aUrlListener);\n</pre>\n\n<h6 id=\"Parameters_4\" name=\"Parameters_4\">Parameters</h6>\n\n<dl>\n <dt><code>aContentType</code></dt>\n <dd>The content type of the attachment</dd>\n <dt><code>aFileName</code></dt>\n <dd>The name of the attachment.</dd>\n <dt><code>aUrl</code></dt>\n <dd>A string representation of the original url associated with the msg.</dd>\n <dt><code>aMessageUri</code></dt>\n <dd><a href=\"/en/RDF\" title=\"en/RDF\">RDF</a> resource that describes the message</dd>\n <dt><code>aDisplayConsumer</code></dt>\n <dd> </dd>\n <dt><code>MsgWindow</code></dt>\n <dd><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> for progress and status feedback</dd>\n <dt><code>aUrlListener</code></dt>\n <dd>An <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code>.</dd>\n</dl>\n\n<h3 id=\"SaveMessageToDisk()\">SaveMessageToDisk()</h3>\n\n<p>When you want to spool a message out to a file on disk. This is an async operation of course.</p><div class=\"blockIndicator note\"><strong>Note:</strong> You must pass in a url listener in order to figure out when the operation is done.</div><p></p>\n\n<pre class=\"eval\"> void SaveMessageToDisk(in string aMessageURI,\n                        in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIFileSpec\" title=\"\">nsIFileSpec</a></code> aFile, \n                        in boolean aGenerateDummyEnvelope,\n                        in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> aUrlListener, \n                        out nsIURI aURL,\n                        in boolean canonicalLineEnding, \n                        in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow);\n</pre>\n\n<h6 id=\"Parameters_5\" name=\"Parameters_5\">Parameters</h6>\n\n<dl>\n <dt><code>aMessageURI</code></dt>\n <dd>Url representing the message to spool out to disk.</dd>\n <dt><code>aFile</code></dt>\n <dd>The file you want the message saved to.</dd>\n <dt><code>aGenerateDummyEnvelope</code></dt>\n <dd>Usually <code>false</code>. Set to <code>true</code> if you want the message appended at the end of the file.</dd>\n <dt><code>aUrlListener</code></dt>\n <dd>A <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> for being notified when the copy is finished.</dd>\n <dt><code>canonicalLineEnding</code></dt>\n <dt><code>aMsgWindow</code></dt>\n <dd><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> for progress and status feedback</dd>\n</dl>\n\n<h6 id=\"Return_values_4\" name=\"Return_values_4\">Return values</h6>\n\n<dl>\n <dt><code>aURL</code></dt>\n <dd>The new <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> of the saved message.</dd>\n</dl>\n\n<p></p><div class=\"blockIndicator note\"><strong>Note:</strong> This operation may be obsolete. You always can use <a href=\"#streamMessage()\">streamMessage</a> to get the <a href=\"/en/Eml\">eml</a> string representation of the message and then write it using <a href=\"/en/Code_snippets/File_I_O\">File I/O Methods</a>.</div><p></p>\n\n<h3 id=\"GetUrlForUri()\">GetUrlForUri()</h3>\n\n<p>When you have a uri and you would like to convert that to a url which can be run through necko, you can use this method. </p><div class=\"blockIndicator note\"><strong>Note:</strong> The Uri MUST refer to a message and not a folder!</div><p></p>\n\n<pre class=\"eval\"> void GetUrlForUri(in string aMessageURI,\n                   out <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> aURL,\n                   in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow);\n</pre>\n\n<h6 id=\"Parameters_6\" name=\"Parameters_6\">Parameters</h6>\n\n<dl>\n <dt><code>aMessageURI</code></dt>\n <dd> </dd>\n <dt><code>aMsgWindow</code></dt>\n <dd><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> for progress and status feedback</dd>\n</dl>\n\n<h6 id=\"Return_values_5\" name=\"Return_values_5\">Return values</h6>\n\n<dl>\n <dt><code>aURL</code></dt>\n <dd>The <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> of the message.</dd>\n</dl>\n\n<h3 id=\"DisplayMessageForPrinting()\">DisplayMessageForPrinting()</h3>\n\n<p>When you want a message displayed in a format that is suitable for printing.</p>\n\n<pre class=\"eval\"> void DisplayMessageForPrinting(in string aMessageURI,\n                                in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports\" title=\"\">nsISupports</a></code> aDisplayConsumer, \n                                in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow,\n                                in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> aUrlListener, \n                                out nsIURI aURL);\n</pre>\n\n<h6 id=\"Parameters_7\" name=\"Parameters_7\">Parameters</h6>\n\n<dl>\n <dt><code>aMessageURI</code></dt>\n <dd>A uri representing the message to display.</dd>\n <dt><code>aDisplayConsumer</code></dt>\n <dd>For now, a <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIDocShell\" title=\"\">nsIDocShell</a></code> which the message is loaded into.</dd>\n <dt><code>aMsgWindow</code></dt>\n <dd><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> for progress and status feedback</dd>\n <dt><code>aUrlListener</code></dt>\n <dd> </dd>\n</dl>\n\n<h6 id=\"Return_values_6\" name=\"Return_values_6\">Return values</h6>\n\n<dl>\n <dt><code>aURL</code></dt>\n <dd>The new <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> of the message.</dd>\n</dl>\n\n<h3 id=\"Search()\">Search()</h3>\n\n<pre class=\"eval\"> void Search(in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgSearchSession\" title=\"\">nsIMsgSearchSession</a></code> aSearchSession,\n             in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow, \n             in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgFolder\" title=\"\">nsIMsgFolder</a></code> aMsgFolder,\n             in string aSearchUri);\n</pre>\n\n<h6 id=\"Parameters_8\" name=\"Parameters_8\">Parameters</h6>\n\n<dl>\n <dt><code>aSearchSession</code></dt>\n <dd>The <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgSearchSession\" title=\"\">nsIMsgSearchSession</a></code> to use.</dd>\n <dt><code>aMsgWindow</code></dt>\n <dd><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> for progress and status feedback</dd>\n <dt><code>aMsgFolder</code></dt>\n <dd><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgFolder\" title=\"\">nsIMsgFolder</a></code></dd>\n <dt><code>aSearchUri</code></dt>\n <dd>url of the search.</dd>\n</dl>\n\n<h3 id=\"streamMessage()\">streamMessage()</h3>\n\n<p>This method streams a message to the passed in consumer. It will also tack <code>aAdditionalHeader</code> onto the url (e.g., <code>header=filter</code>). The good thing about this method is that you can extract a standard representation of any message, no matter if they are emails, <a href=\"/en/RSS\" title=\"en/RSS\">RSS</a>, news, blogs, etc.</p>\n\n<pre class=\"eval\"> nsIURI streamMessage(in string aMessageURI,\n                      in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports\" title=\"\">nsISupports</a></code> aConsumer, \n                      in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> aMsgWindow,\n                      in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> aUrlListener,  \n                      in boolean aConvertData,\n                      in string aAdditionalHeader);\n</pre>\n\n<h6 id=\"Parameters_9\" name=\"Parameters_9\">Parameters</h6>\n\n<dl>\n <dt><code>aMessageURI</code></dt>\n <dd>uri of message to stream</dd>\n <dt><code>aConsumer</code></dt>\n <dd>Generally, a stream listener listening to the message. The consumer has to be a stream listener and in your listener's <code>onDataAvailable</code> method, you can write out the stream data to a local file or concatenate it to a string.</dd>\n <dt><code>aMsgWindow</code></dt>\n <dd><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow\" title=\"\">nsIMsgWindow</a></code> for progress and status feedback.</dd>\n <dt><code>aUrlListener</code></dt>\n <dd>An <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> that is notified when url starts and stops.</dd>\n <dt><code>aConvertData</code></dt>\n <dd>If <code>aConvertData</code> is true, it will create a stream converter from message <a class=\"external\" href=\"http://tools.ietf.org/html/rfc2822\">rfc2822</a> to */*.</dd>\n <dt><code>aAdditionalHeader</code></dt>\n <dd>Header added to the URI. e.g., <code>header=filter</code></dd>\n</dl>\n\n<h6 id=\"Return\" name=\"Return\">Return</h6>\n\n<p>The <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> that gets run</p>\n\n<h6 id=\"Example\" name=\"Example\">Example</h6>\n\n<p>For example, the next piece of code shows the selected message code on a dialog: (taken from <a class=\"external\" href=\"http://forums.mozillazine.org/viewtopic.php?t=214824\">Mozillazine</a>)</p>\n\n<pre>  var content = \"\";\n  var MessageURI = GetFirstSelectedMessage();\n  var MsgService = messenger.messageServiceFromURI(MessageURI);\n  var MsgStream =  Components.classes[\"@mozilla.org/network/sync-stream-listener;1\"].createInstance();\n  var consumer = MsgStream.QueryInterface(Components.interfaces.nsIInputStream);\n  var ScriptInput = Components.classes[\"@mozilla.org/scriptableinputstream;1\"].createInstance();\n  var ScriptInputStream = ScriptInput.QueryInterface(Components.interfaces.nsIScriptableInputStream);\n  ScriptInputStream.init(consumer);\n  try {\n    MsgService.streamMessage(MessageURI, MsgStream, msgWindow, null, false, null);\n  } catch (ex) {\n    alert(\"error: \"+ex)\n  }\n  ScriptInputStream .available();\n  while (ScriptInputStream .available()) {\n    content = content + ScriptInputStream .read(512);\n  }\n  alert(content\n</pre>\n\n<h3 id=\"streamHeaders()\">streamHeaders()</h3>\n\n<p>This method streams a message's headers to the passed in consumer. This is for consumers who want a particular header but don't want to stream the whole message.</p>\n\n<pre class=\"eval\"> nsIURI streamMessage(in string aMessageURI,\n                      in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIStreamListener\" title=\"\">nsIStreamListener</a></code> aConsumer, \n                      in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> aUrlListener,  \n                      in boolean aLocalOnly);\n</pre>\n\n<h6 id=\"Parameters_9\" name=\"Parameters_9\">Parameters</h6>\n\n<dl>\n <dt><code>aMessageURI</code></dt>\n <dd>uri of message to stream</dd>\n <dt><code>aConsumer</code></dt>\n <dd><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIStreamListener\" title=\"\">nsIStreamListener</a></code> Generally, a stream listener listening to the message headers. The consumer has to be a stream listener and in your listener's <code>onDataAvailable</code> method, you can write out the stream data to a local file or concatenate it to a string.</dd>\n <dt><code>aUrlListener</code></dt>\n <dd>An <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIUrlListener\" title=\"\">nsIUrlListener</a></code> that is notified when url starts and stops, if we run a url.</dd>\n</dl>\n\n<dl>\n <dt><code>aLocalOnly</code></dt>\n <dd>Whether data should be retrieved only from local caches. If streaming over the network is required and this is true, then an exception is thrown. This defaults to false.</dd>\n</dl>\n\n<h6 id=\"Return\" name=\"Return\">Note</h6>\n\n<p>If we're offline, then even if aLocalOnly is false, we won't stream over the network</p>\n\n<h6 id=\"Return\" name=\"Return\">Return</h6>\n\n<p>The URL that gets run, if any</p>\n\n<h3 id=\"isMsgInMemCache()\">isMsgInMemCache()</h3>\n\n<p>Determines whether a message is in the memory cache. Local folders don't implement this.</p>\n\n<pre class=\"eval\"> boolean isMsgInMemCache(in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> aUrl,\n                         in <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgFolder\" title=\"\">nsIMsgFolder</a></code> aFolder, \n                        out <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsICacheEntryDescriptor\" title=\"\">nsICacheEntryDescriptor</a></code> aCacheEntry);\n</pre>\n\n<h6 id=\"Parameters_9\" name=\"Parameters_9\">Parameters</h6>\n\n<dl>\n <dt><code>aUrl</code></dt>\n <dd>The URL of the message, possibly with an appropriate command in it</dd>\n <dt><code>aFolder</code></dt>\n <dd>The folder this message is in</dd>\n <dt><code>aCacheEntry</code></dt>\n <dd>If a cache entry is found, then a pointer to it</dd>\n</dl>\n\n<h6 id=\"Return\" name=\"Return\">Return</h6>\n\n<p>TRUE if the message is in mem cache; FALSE if it is not.</p>\n\n<h3 id=\"messageURIToMsgHdr()\">messageURIToMsgHdr()</h3>\n\n<p>Go from message uri to <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgDBHdr\" title=\"\">nsIMsgDBHdr</a></code>:</p>\n\n<pre class=\"eval\"> <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgDBHdr\" title=\"\">nsIMsgDBHdr</a></code> messageURIToMsgHdr(in string uri);\n</pre>\n\n<h6 id=\"Parameters_10\" name=\"Parameters_10\">Parameters</h6>\n\n<dl>\n <dt><code>uri</code></dt>\n <dd>url of the message</dd>\n</dl>\n\n<h6 id=\"Return_2\" name=\"Return_2\">Return</h6>\n\n<p>The URL that gets run, if any.</p>",
    "contributors": "<a href=\"https://developer.mozilla.org/en-US/profiles/wbamberg\">wbamberg</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/mdnwebdocs-bot\">mdnwebdocs-bot</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/fscholz\">fscholz</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/RealRaven2000\">RealRaven2000</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Sheppy\">Sheppy</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/jswisher\">jswisher</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Oeekker\">Oeekker</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Smi\">Smi</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Wjjohnst\">Wjjohnst</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/EyalRozenberg\">EyalRozenberg</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Msemlitsch\">Msemlitsch</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Cancerbero%20sgx\">Cancerbero sgx</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Nickolay\">Nickolay</a>",
    "title": "nsIMsgMessageService"
}