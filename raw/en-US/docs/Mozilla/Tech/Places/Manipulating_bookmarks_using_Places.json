{
    "content": "<div class=\"noinclude\">\n<p></p>\n</div>\n\n<p>The Places bookmarks service, provided by the <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsINavBookmarksService\" title=\"\">nsINavBookmarksService</a></code> interface, provides methods for creating, deleting, and manipulating bookmarks and bookmark folders. This article offers examples for how to perform common bookmark management tasks using the bookmarks service.</p>\n\n<h3 id=\"Initiating_the_bookmarks_service\" name=\"Initiating_the_bookmarks_service\">Initiating the bookmarks service</h3>\n\n<p>As is the case with nearly all interfaces, before you can use the bookmarks service, you need to get access to it:</p>\n\n<pre class=\"eval\">var bmsvc = Components.classes[\"@mozilla.org/browser/nav-bookmarks-service;1\"]\n                      .getService(Components.interfaces.nsINavBookmarksService);\n</pre>\n\n<h3 id=\"Creating_a_bookmark_folder\" name=\"Creating_a_bookmark_folder\">Creating a bookmark folder</h3>\n\n<p>Creating a new bookmark folder is done using the <code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsINavBookmarksService#createFolder()\">nsINavBookmarksService.createFolder()</a></code> method. For example, to create a new folder in the Bookmarks menu:</p>\n\n<pre class=\"eval\">var menuFolder = bmsvc.bookmarksMenuFolder; // Bookmarks menu folder\nvar newFolderId = bmsvc.createFolder(menuFolder, \"Folder name here\", bmsvc.DEFAULT_INDEX);\n</pre>\n\n<p>This code locates the Bookmarks menu's folder, then creates a new folder named \"Folder name here\" in it. Specifying DEFAULT_INDEX as the index at which to insert the new folder places it at the end of the list.</p>\n\n<p>You can easily change this code to insert the new folder into the bookmarks toolbar by changing <code>bookmarksMenuFolder</code> to <a class=\"internal\" href=\"/en/nsINavBookmarksService#Attributes\" title=\"en/nsINavBookmarksService#Attributes\">another folder attribute</a>.</p>\n\n<h3 id=\"Creating_a_new_bookmark\" name=\"Creating_a_new_bookmark\">Creating a new bookmark</h3>\n\n<p>To create a new bookmark, use the <code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsINavBookmarksService#insertBookmark()\">nsINavBookmarksService.insertBookmark()</a></code> method. The URI for the bookmark needs to be specified using an <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> object.</p>\n\n<pre class=\"eval\">var ios = Components.classes[\"@mozilla.org/network/io-service;1\"]\n                    .getService(Components.interfaces.nsIIOService);\nvar uri = ios.newURI(<span class=\"nowiki\">\"http://google.com/\"</span>, null, null);\nvar newBkmkId = bmsvc.insertBookmark(newFolderId, uri, bmsvc.DEFAULT_INDEX, \"\");\n</pre>\n\n<p>This example instantiates the <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIIOService\" title=\"\">nsIIOService</a></code> and uses it to create an <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI\" title=\"\">nsIURI</a></code> referring to the Google web site, then calls <code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsINavBookmarksService#insertBookmark()\">nsINavBookmarksService.insertBookmark()</a></code> to create a new bookmark to Google, placing it at the end of the bookmarks folder referenced by <code>newBkmkId</code>.</p>\n\n<h3 id=\"Finding_bookmark_items\" name=\"Finding_bookmark_items\">Finding bookmark items</h3>\n\n<p>If you know the URI of a site and wish to find all bookmarks that link to it, you can use the <code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsINavBookmarksService#getBookmarkIdsForURI()\">nsINavBookmarksService.getBookmarkIdsForURI()</a></code> method.</p>\n\n<pre class=\"eval\">var ios = Components.classes[\"@mozilla.org/network/io-service;1\"]\n                    .getService(Components.interfaces.nsIIOService);\nvar uri = ios.newURI(<span class=\"nowiki\">\"http://google.com/\"</span>, null, null);\nvar bookmarksArray = bmsvc.getBookmarkIdsForURI(uri, {});\n</pre>\n\n<p>After executing this code, the array bookmarksArray contains the IDs of all bookmarks that refer to the specified URI (in this case, <span class=\"nowiki\">\"http://google.com\"</span>).</p>\n\n<h3 id=\"Manipulating_existing_items\" name=\"Manipulating_existing_items\">Manipulating existing items</h3>\n\n<p>There are a number of convenient methods you can use to make changes to existing bookmarks and bookmark folders. This section covers some of them.</p>\n\n<h4 id=\"The_item_title\" name=\"The_item_title\">The item title</h4>\n\n<p>To change the title of a bookmark or bookmark folder, you use the <code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsINavBookmarksService#setItemTitle()\">nsINavBookmarksService.setItemTitle()</a></code> method.</p>\n\n<pre class=\"eval\">bmsvc.setItemTitle(newBkmkId, \"New title\");\n</pre>\n\n<p>This sets the title of the item referenced by the ID <code>newBkmkId</code> to \"New title\".</p>\n\n<p>You can fetch the current title of an item using the <code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsINavBookmarksService#getItemTitle()\">nsINavBookmarksService.getItemTitle()</a></code> method:</p>\n\n<pre class=\"eval\">var thisTitle = bmsvc.getItemTitle(newBkmkId);\n</pre>\n\n<p>This code will display an alert containing the title of the item referenced by the ID <code>newBkmkId</code>.</p>\n\n<h4 id=\"The_item_URI\" name=\"The_item_URI\">The item URI</h4>\n\n<p>Similarly, you can obtain the URI corresponding to a given bookmark item by calling the <code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsINavBookmarksService#getBookmarkURI()\">nsINavBookmarksService.getBookmarkURI()</a></code> method.</p>\n\n<pre class=\"eval\">var thisURI = bmsvc.getBookmarkURI(newBkmkId);\n</pre>\n\n<p>Assuming you've run all the code samples previous to this one, this will output <span class=\"nowiki\">\"http://google.com\"</span>.</p>\n\n<p>You can use the <code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsINavBookmarksService#changeBookmarkURI()\">nsINavBookmarksService.changeBookmarkURI()</a></code> method to update the URI for a given bookmark item:</p>\n\n<pre class=\"eval\">var uri = ios.newURI(<span class=\"nowiki\">\"http://mozilla.com/\"</span>, null, null);\nbmsvc.changeBookmarkURI(newBkmkId, uri);\n</pre>\n\n<p>This example changes the bookmark to refer to the Mozilla web site instead of Google.</p>\n\n<p></p><div class=\"blockIndicator note\"><strong>Note:</strong> All annotations, tags, and so forth are kept when the bookmark's URI is changed.</div><p></p>\n\n<h3 id=\"Checking_to_see_if_a_URI_is_bookmarked\" name=\"Checking_to_see_if_a_URI_is_bookmarked\">Checking to see if a URI is bookmarked</h3>\n\n<p>If you want to see if a given URI is already bookmarked -- for example, to avoid creating a new bookmark for a site that's already bookmarked -- you can use the <code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsINavBookmarksService#isBookmarked()\">nsINavBookmarksService.isBookmarked()</a></code> method.</p>\n\n<pre class=\"eval\">var ios = Components.classes[\"@mozilla.org/network/io-service;1\"]\n                    .getService(Components.interfaces.nsIIOService);\nvar uri = ios.newURI(<span class=\"nowiki\">\"http://mozilla.com/\"</span>, null, null);\nif (!bmsvc.isBookmarked(uri)) {\n  bmsvc.insertBookmark(bmsvc.toolbarFolder, uri, bmsvc.DEFAULT_INDEX, \"Mozilla\");\n}\n</pre>\n\n<p>This example looks to see if the user already has a bookmark for the Mozilla web site, and, if not, creates one, adding it to the user's bookmarks toolbar.</p>\n\n<h3 id=\"Finding_the_folder_containing_an_item\" name=\"Finding_the_folder_containing_an_item\">Finding the folder containing an item</h3>\n\n<p>If you need to know what folder contains an item (this can be especially handy after using <code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsINavBookmarksService#getBookmarkIdsForURI()\">nsINavBookmarksService.getBookmarkIdsForURI()</a></code> to find bookmarks for a given URI), you can use the <code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsINavBookmarksService#getFolderIdForItem()\">nsINavBookmarksService.getFolderIdForItem()</a></code> method.</p>\n\n<pre class=\"eval\">var parentFolderId = bmsvc.getFolderIdForItem(newBkmkId);\n</pre>\n\n<h3 id=\"Observing_changes_to_bookmarks_and_tags\" name=\"Observing_changes_to_bookmarks_and_tags\">Observing changes to bookmarks and tags</h3>\n\n<p>To set up an observer to listen for changes related to bookmarks, you will need to create an <code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsINavBookmarkObserver\" title=\"\">nsINavBookmarkObserver</a></code> object and use the <code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsINavBookmarksService#addObserver()\">nsINavBookmarksService.addObserver()</a></code> and <code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsINavBookmarksService#removeObserver()\">nsINavBookmarksService.removeObserver()</a></code> methods.  Note that this example takes advantage of <a class=\"internal\" href=\"/En/XPCOMUtils.jsm\" title=\"En/XPCOMUtils.jsm\">XPCOMUtils</a> to generate the <code><a href=\"https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsISupports#QueryInterface()\">nsISupports.QueryInterface()</a></code> method.</p>\n\n<pre class=\"eval\">// An nsINavBookmarkObserver\nvar myExt_bookmarkListener = {\n  onBeginUpdateBatch: function() {},\n  onEndUpdateBatch: function() {},\n  onItemAdded: function(aItemId, aFolder, aIndex) {},\n  onItemRemoved: function(aItemId, aFolder, aIndex) {},\n  onItemChanged: function(aBookmarkId, aProperty, aIsAnnotationProperty, aValue) {\n    MyExtension.doSomething();\n  },\n  onItemVisited: function(aBookmarkId, aVisitID, time) {},\n  onItemMoved: function(aItemId, aOldParent, aOldIndex, aNewParent, aNewIndex) {},\n  QueryInterface: XPCOMUtils.generateQI([Components.interfaces.nsINavBookmarkObserver])\n};\n// An extension\nvar MyExtension = {\n  // This function is called when my add-on is loaded\n  onLoad: function() {\n    bmsvc.addObserver(myExt_bookmarkListener, false);\n  },\n  // This function is called when my add-on is unloaded\n  onUnLoad: function() {\n    bmsvc.removeObserver(myExt_bookmarkListener);\n  },\n  doSomething: function() {\n    alert(\"Did something.\");\n  }\n};\n</pre>\n\n<h3 id=\"See_also\" name=\"See_also\">See also</h3>\n\n<ul>\n <li><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsINavBookmarksService\" title=\"\">nsINavBookmarksService</a></code></li>\n <li><code><a href=\"/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsINavBookmarkObserver\" title=\"\">nsINavBookmarkObserver</a></code></li>\n <li><a href=\"/en-US/docs/Places\">Places</a></li>\n <li><a href=\"/en-US/Add-ons/SDK/Tutorials/Using_XPCOM_without_chrome#Bookmarks_Observer\">Using XPCOM without chrome - Bookmark Observer</a></li>\n</ul>",
    "contributors": "<a href=\"https://developer.mozilla.org/en-US/profiles/wbamberg\">wbamberg</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/mdnwebdocs-bot\">mdnwebdocs-bot</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/e-motiv\">e-motiv</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/teoli\">teoli</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/DavidWalsh\">DavidWalsh</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/trevorh\">trevorh</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/sdwilsh\">sdwilsh</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Gomita\">Gomita</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/MarkFinkle\">MarkFinkle</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Mk\">Mk</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Mgjbot\">Mgjbot</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Kohei\">Kohei</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Sheppy\">Sheppy</a>",
    "title": "Manipulating bookmarks using Places"
}