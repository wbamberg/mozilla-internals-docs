{
    "content": "<div class=\"noinclude\">\n  <span class=\"breadcrumbs XULRefMeth_breadcrumbs\">Â« <a href=\"/en-US/docs/XUL_Reference\" title=\"/en-US/docs/XUL_Reference\">XUL Reference home</a></span></div>\n<dl>\n  <dt>\n    <span id=\"m-insertItemAt\"><code><a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XUL/Method/insertItemAt\">insertItemAt( index, label, value )</a></code></span></dt>\n  <dd>\n    Return type: <em>element</em></dd>\n  <dd>\n    This method creates a new item and inserts it at the specified position. You may optionally set a value. The new item element is returned.</dd>\n</dl>\n<div class=\"noinclude\">\n  <p><strong>Note:</strong> You cannot insert an item to an index that does not exist, eg: trying to insert an item at the end with <code>element.getRowCount() + 1</code></p>\n  <h3 id=\"Example\" name=\"Example\">Example</h3>\n  <pre>&lt;!-- This example inserts at the selected item or appends, then selects the newly created item --&gt;\n&lt;script language=\"javascript\"&gt;\nfunction insertItemToList(){\n\n    var myListBox = document.getElementById('myListBox');\n\n    // create a date to get some labels and values\n    var someDate = new Date();\n\n    if(myListBox.selectedIndex == -1){\n        // no item was selected in list so append to the end\n        myListBox.appendItem( someDate.toLocaleTimeString(), someDate.getTime() );\n        var newIndex = myListBox.getRowCount()  -1\n    }else{\n        // item was selected so insert at the selected item\n        var newIndex =  myListBox.selectedIndex;\n        myListBox.insertItemAt(newIndex, someDate.toLocaleTimeString(), someDate.getTime());\n    }\n\n    // select the newly created item\n    myListBox.selectedIndex = newIndex;\n}\n&lt;/script&gt;\n\n&lt;button label=\"Insert item at selected\" oncommand=\"insertItemToList()\"/&gt;\n&lt;listbox id=\"myListBox\"&gt;\n    &lt;listitem label=\"foo\"/&gt;\n&lt;/listbox&gt;\n</pre>\n  <h3 id=\"See_also\" name=\"See_also\">See also</h3>\n  <ul>\n    <li><span id=\"m-appendItem\"><code><a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XUL/Method/appendItem\">appendItem()</a></code></span></li>\n    <li><span id=\"m-removeItemAt\"><code><a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XUL/Method/removeItemAt\">removeItemAt()</a></code></span></li>\n  </ul>\n</div>",
    "contributors": "<a href=\"https://developer.mozilla.org/en-US/profiles/wbamberg\">wbamberg</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/mdnwebdocs-bot\">mdnwebdocs-bot</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Sheppy\">Sheppy</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/trevorh\">trevorh</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Marsf\">Marsf</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Enn\">Enn</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Mgjbot\">Mgjbot</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Ptak82\">Ptak82</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/MarkFinkle\">MarkFinkle</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Pmash\">Pmash</a>, <a href=\"https://developer.mozilla.org/en-US/profiles/Dria\">Dria</a>",
    "title": "insertItemAt"
}